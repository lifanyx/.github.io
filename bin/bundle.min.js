!function t(e,i,n){function a(s,r){if(!i[s]){if(!e[s]){var l="function"==typeof require&&require;if(!r&&l)return l(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var h=i[s]={exports:{}};e[s][0].call(h.exports,function(t){var i=e[s][1][t];return a(i?i:t)},h,h.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)a(n[s]);return a}({1:[function(t,e,i){!function(t){var i=/iPhone/i,n=/iPod/i,a=/iPad/i,o=/(?=.*\bAndroid\b)(?=.*\bMobile\b)/i,s=/Android/i,r=/(?=.*\bAndroid\b)(?=.*\bSD4930UR\b)/i,l=/(?=.*\bAndroid\b)(?=.*\b(?:KFOT|KFTT|KFJWI|KFJWA|KFSOWI|KFTHWI|KFTHWA|KFAPWI|KFAPWA|KFARWI|KFASWI|KFSAWI|KFSAWA)\b)/i,u=/Windows Phone/i,h=/(?=.*\bWindows\b)(?=.*\bARM\b)/i,_=/BlackBerry/i,d=/BB10/i,c=/Opera Mini/i,p=/(CriOS|Chrome)(?=.*\bMobile\b)/i,f=/(?=.*\bFirefox\b)(?=.*\bMobile\b)/i,g=new RegExp("(?:Nexus 7|BNTV250|Kindle Fire|Silk|GT-P1000)","i"),y=function(t,e){return t.test(e)},m=function(t){var e=t||navigator.userAgent,m=e.split("[FBAN");if("undefined"!=typeof m[1]&&(e=m[0]),m=e.split("Twitter"),"undefined"!=typeof m[1]&&(e=m[0]),this.apple={phone:y(i,e),ipod:y(n,e),tablet:!y(i,e)&&y(a,e),device:y(i,e)||y(n,e)||y(a,e)},this.amazon={phone:y(r,e),tablet:!y(r,e)&&y(l,e),device:y(r,e)||y(l,e)},this.android={phone:y(r,e)||y(o,e),tablet:!y(r,e)&&!y(o,e)&&(y(l,e)||y(s,e)),device:y(r,e)||y(l,e)||y(o,e)||y(s,e)},this.windows={phone:y(u,e),tablet:y(h,e),device:y(u,e)||y(h,e)},this.other={blackberry:y(_,e),blackberry10:y(d,e),opera:y(c,e),firefox:y(f,e),chrome:y(p,e),device:y(_,e)||y(d,e)||y(c,e)||y(f,e)||y(p,e)},this.seven_inch=y(g,e),this.any=this.apple.device||this.android.device||this.windows.device||this.other.device||this.seven_inch,this.phone=this.apple.phone||this.android.phone||this.windows.phone,this.tablet=this.apple.tablet||this.android.tablet||this.windows.tablet,"undefined"==typeof window)return this},w=function(){var t=new m;return t.Class=m,t};"undefined"!=typeof e&&e.exports&&"undefined"==typeof window?e.exports=m:"undefined"!=typeof e&&e.exports&&"undefined"!=typeof window?e.exports=w():"function"==typeof define&&define.amd?define("isMobile",[],t.isMobile=w()):t.isMobile=w()}(this)},{}],2:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=t("./Common"),r=n(s),l=t("./scenes/GallerySelectionScene"),u=n(l),h=t("./scenes/ImageSelectionScene"),_=n(h),d=t("./scenes/GameScene"),c=n(d),p=t("./scenes/MainScene"),f=n(p),g=t("./SavedData"),y=n(g),m=function(){function t(){a(this,t)}return o(t,null,[{key:"init",value:function(){r["default"].assets.texture=r["default"].assets.texture.bind(r["default"].assets),t.showMainScene(),r["default"].savedData=new y["default"],r["default"].savedData.init()}},{key:"showMainScene",value:function(){r["default"].paused=!1;var e=new f["default"];return e.signals.next.add(function(){t.showGallerySelectionScene()},this),r["default"].scene.show(e),e}},{key:"showGameScene",value:function(){var e=new c["default"];return e.signals.next.add(function(e){t.showGameScene()},this),e.signals.previous.add(function(e){t.showImageSelectionScene()},this),e.signals.home.add(function(e){t.showMainScene()},this),r["default"].scene.show(e),e}},{key:"showImageSelectionScene",value:function(){var e=new _["default"];return e.signals.next.add(function(e){t.showGameScene()},this),e.signals.previous.add(function(e){t.showGallerySelectionScene()},this),e.signals.home.add(function(e){t.showMainScene()},this),r["default"].scene.show(e),e}},{key:"showGallerySelectionScene",value:function(){var e=new u["default"];return e.signals.next.add(function(e){t.showImageSelectionScene()},this),e.signals.previous.add(function(e){t.showMainScene()},this),e.signals.home.add(function(e){t.showMainScene()},this),r["default"].scene.show(e),e}}]),t}();i["default"]=m},{"./Common":3,"./SavedData":6,"./scenes/GallerySelectionScene":27,"./scenes/GameScene":28,"./scenes/ImageSelectionScene":29,"./scenes/MainScene":30}],3:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(){}Object.defineProperty(i,"__esModule",{value:!0});var s=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},l=t("./Application");n(l);i["default"]=o,o.main={assetRes:1},o.themeIndex=0,o.killGlowSignal=new signals.Signal,o.toggleCurrentGlowSignal=new signals.Signal,o.buttonsAppear=function(t){for(var e=0;e<t.length;e++)t[e].scale.set(0),TweenMax.to(t[e].scale,.34,{x:1,y:1,ease:Back.easeOut,easeParams:[2],delay:.15*e+.25})},o.assets=null,o.view=null,o.paused=!1,o.isWebGL=!1,o.isFirstPlay=!0,o.isDebug=!1,o.isMute=!1,o.game_key="rozhc7o7-dsn-create-v1.0",o.audio=null,o.camera=null,o.PHYSICS_TICK=1/30,o.copy=null,o.config=null,o.language="",o.STAGE_WIDTH=1664,o.STAGE_HEIGHT=768,o.stage=null,o.renderer=null,o.saveMute=function(){var t={isMute:o.isMute};localStorage.setItem(o.game_key+"_isMute",JSON.stringify(t))},o.loadMute=function(){var t=JSON.parse(localStorage.getItem(o.game_key+"_isMute"));t&&(o.isMute=t.isMute,o.audio.mute(o.isMute))},o.saveGame=function(){var t={highestScore:o.highestScore};localStorage.setItem(o.game_key,JSON.stringify(t))},o.loadGame=function(){var t=JSON.parse(localStorage.getItem(o.game_key));t?(o.highestScore=t.highestScore,o.isFirstPlay=!1):o.isFirstPlay=!0},o.shuffleString=function(t){for(var e=t.split(""),i=e.length,n=i-1;n>0;n--){var a=Math.floor(Math.random()*(n+1)),o=e[n];e[n]=e[a],e[a]=o}return e.join("")},o.shuffleArr=function(t){for(var e=t.length;e;e--){var i=Math.floor(Math.random()*e),n=[t[i],t[e-1]];t[e-1]=n[0],t[i]=n[1]}return t},o.randomID=function(t){return t=t||8,Math.random().toString(36).substr(2,t)},o.angle=function(t,e,i,n){var a=n-e,o=i-t;return Math.atan2(a,o)},o.distance=function(t,e,i,n){return Math.sqrt((t-i)*(t-i)+(e-n)*(e-n))},o.deg2rad=function(t){return t*(Math.PI/180)},o.rad2deg=function(t){return 180*t/Math.PI},o.keyboard=function(t){var e={};return e.code=t,e.isDown=!1,e.isUp=!0,e.down=void 0,e.up=void 0,e.downHandler=function(t){t.keyCode===e.code&&(e.isUp&&e.down&&e.down(),e.isDown=!0,e.isUp=!1),t.preventDefault()},e.upHandler=function(t){t.keyCode===e.code&&(e.isDown&&e.up&&e.up(),e.isDown=!1,e.isUp=!0),t.preventDefault()},window.addEventListener("keydown",e.downHandler.bind(e),!1),window.addEventListener("keyup",e.upHandler.bind(e),!1),e},o.genTex=function(t,e,i,n){var a=new PIXI.Graphics;return i?a.beginFill(i):a.beginFill(4095),"rect"===n?a.drawRect(0,0,t,e):"circle"===n?a.drawEllipse(0,0,t,e):a.drawRect(0,0,t,e),a.endFill(),o.renderer.generateTexture(a)},o.generateRect=function(t,e,i,n){var a=new PIXI.Graphics;i?a.beginFill(i):a.beginFill(4095),a.lineStyle(5,14277081),a.drawRect(0,0,t,e),a.endFill();var s=o.renderer.generateTexture(a),r=new PIXI.Sprite(s);return r.anchor={x:.5,y:.5},a.destroy(),n?(r.destroy(),s):r},o.generateEllipse=function(t,e,i,n){var a=new PIXI.Graphics;i?a.beginFill(i):a.beginFill(16773120),a.drawEllipse(0,0,t,e),a.endFill();var s=o.renderer.generateTexture(a),r=new PIXI.Sprite(s);return r.anchor.set(.5),a.destroy(),n?s:r},o.centreAnchor=function(t){for(var e=0;e<arguments.length;e++)arguments[e].anchor.set(.5)},o.matrix=function(t,e,i){for(var n=[],a=0;a<t;a++){for(var o=[],s=0;s<e;s++)o[s]=i;n[a]=o}return n},o.array=function(t,e){for(var i=[],n=0;n<t;n++)i.push(e);return i},o.sort=function(t,e){function i(n,a){function o(e,i){var n=t[e];t[e]=t[i],t[i]=n}function s(){var i=t[n],s=n;o(s,a);for(var r=n;r<a;r++)!e&&t[r]<i?o(s++,r):e&&t[r]>i&&o(s++,r);return o(s,a),s}if(n<a){var r=s();i(n,r-1),i(r+1,a)}}var n=t.length-1;return i(0,n),t},o.sortTiles=function(t){return t.sort(function(t,e){return t.y==e.y?t.x-e.x:t.y-e.y}),t},o.sortBy=function(t,e,i){function n(i,a){function o(e,i){var n=t[e];t[e]=t[i],t[i]=n}function s(){var n=t[i],s=i;o(s,a);for(var r=i;r<a;r++)e?x?t[r].x>n.x&&o(s++,r):t[r].y>n.y&&o(s++,r):x?t[r].x<n.x&&o(s++,r):t[r].y<n.y&&o(s++,r);return o(s,a),s}if(i<a){var r=s();n(i,r-1),n(r+1,a)}}var a=t.length-1;return n(0,a),t},o.sortDistances=function(t,e){function i(n,a){function o(e,i){var n=t[e];t[e]=t[i],t[i]=n}function s(){var i=t[n],s=n;o(s,a);for(var r=n;r<a;r++)e?t[r].distance>i.distance&&o(s++,r):t[r].distance<i.x&&o(s++,r);return o(s,a),s}if(n<a){var r=s();i(n,r-1),i(r+1,a)}}e=e||!1;var n=t.length-1;return i(0,n),t},o.compareXY=function(t,e){return Math.round(t.x)===Math.round(e.x)&&Math.round(t.y)===Math.round(e.y)},o.lerpAxis=function(t,e,i){return(e-t)*i+t},o.lerpVector=function(t,e,i){return o.Vector.add(o.Vector.scale(o.Vector.sub(t,e),i),t)},o.Vector={add:function(t,e){if(void 0===t.x||void 0===e.x)throw new Error("Vector.add() must be passed a pair of vectors");return{x:t.x+e.x,y:t.y+e.y}},sub:function(t,e){if(void 0===t.x||void 0===e.x)throw new Error("Vector.sub() must be passed a pair of vectors");return{x:t.x-e.x,y:t.y-e.y}},mult:function(t,e){if(void 0===t.x||void 0===e.x)throw new Error("Vector.mult() must be passed a pair of vectors");return{x:t.x*e.x,y:t.y*e.y}},div:function(t,e){if(void 0===t.x||void 0===e.x)throw new Error("Vector.div() must be passed a pair of vectors");return{x:t.x/e.x,y:t.y/e.y}},scale:function(t,e){if(void 0===t.x)throw new Error("Vector.scale() must be passed a vector for first arg");return{x:t.x*e,y:t.y*e}}},o.lookAt=function(t,e,i){var n=Math.atan2(e.y-t.y,e.x-t.x);return i&&(t.rotation=n),n},o.detectCircularRef=function(t){function e(t){var a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];Object.keys(t).forEach(function(o){var s=t[o],r=a.slice();r.push(o);try{JSON.stringify(s)}catch(l){var u,h="";try{h=JSON.stringify(s,i(s),2),u=!0}catch(l){e(s,r),u=!1}if(u)throw new Error('Circular reference detected:\nCircularly referenced value is value under path "'+n(r)+'" of the given root object\n'+("Calling stringify on this value but replacing itself with [Circular object --- fix me] ( <-- search for this string) results in:\n"+h+"\n"))}})}function i(t){var e=0;return function(i,n){return 0!==e&&"object"===("undefined"==typeof t?"undefined":r(t))&&t===n?"[Circular object --- fix me]":(e++,n)}}function n(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:":";return 0===t.length?"":t.reduce(function(t,i){return""+t+e+i})}return e(t)},o.pinchable=function(t,e){function i(e){t.on("touchmove",n)}function n(e){var i=e.data.originalEvent.targetTouches;if(i&&!(i.length<2)){var n=i[0].clientX-i[1].clientX,a=i[0].clientY-i[1].clientY,o=Math.sqrt(n*n+a*a);if(!t._pinch)return t._pinch={p:{distance:o,date:new Date}},void t.emit("pinchstart");var s=new Date,r=s-t._pinch.p.date;if(!(r<12)){var l={x:(i[0].clientX+i[1].clientX)/2,y:(i[0].clientY+i[1].clientY)/2},u={scale:o/t._pinch.p.distance,velocity:o/r,center:l,data:e.data};t.emit("pinchmove",u),t._pinch.pp={distance:t._pinch.p.distance,date:t._pinch.p.date},t._pinch.p={distance:o,date:s}}}}function a(i){if(t.removeListener("touchmove",n),t._pinch)if(e&&t._pinch.pp){if(t._pinch.intervalId)return;var a=new Date-t._pinch.p.date,o=(t._pinch.p.distance-t._pinch.pp.distance)/a,s=t._pinch.p.center,r=t._pinch.p.distance;t._pinch.intervalId=setInterval(function(){if(Math.abs(o)<.04)return clearInterval(t._pinch.intervalId),t.emit("pinchend"),void(t._pinch=null);var e=r+12*o,n={scale:e/r,velocity:o,center:s,data:i.data};t.emit("pinchmove",n),r=e,o*=.8},12)}else t.emit("pinchend"),t._pinch=null}t.interactive=!0,t.on("touchstart",i),t.on("touchend",a),t.on("touchendoutside",a)},o.getAndroidVersion=function(t){t=(t||navigator.userAgent).toLowerCase();var e=t.match(/android\s([0-9\.]*)/);return!!e&&e[1]},o.erraticTween=function(t,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{delay:0};return i.ease=CustomEase.create("custom","M0,0,C0,0,0.065,0.167,0.08,0.205,0.09,0.2,0.124,0.182,0.135,0.176,0.157,0.223,0.21,0.59,0.22,0.608,0.223,0.585,0.298,0.12,0.3,0.111,0.3,0.118,0.309,0.262,0.315,0.345,0.322,0.36,0.325,0.372,0.335,0.388,0.352,0.417,0.372,0.439,0.39,0.463,0.391,0.502,0.394,0.58,0.395,0.583,0.396,0.578,0.418,0.461,0.43,0.399,0.431,0.397,0.463,0.611,0.464,0.61,0.475,0.621,0.488,0.448,0.495,0.455,0.495,0.449,0.498,0.417,0.5,0.404,0.512,0.401,0.562,0.262,0.572,0.26,0.577,0.293,0.568,0.499,0.58,0.568,0.597,0.639,0.603,0.787,0.608,0.806,0.616,0.794,0.698,0.64,0.705,0.63,0.705,0.638,0.708,0.685,0.71,0.72,0.711,0.734,0.713,0.745,0.715,0.756,0.719,0.759,0.737,0.781,0.742,0.784,0.746,0.83,0.743,0.912,0.745,0.925,0.756,0.907,0.863,0.732,0.88,0.705,0.894,0.741,1,1,1,1"),TweenMax.to(t,e,i)};var u=function(){function t(){a(this,t),this._graph=null,this._source=null,this._target=null,this._verts=[],this._paths=null}return s(t,[{key:"init",value:function(){if(!this._graph)throw new Error("must set graph before init");if(!this._source)throw new Error("must set source before init");for(var t=0;t<this._graph.length;t++)for(var e=0;e<this._graph[t].length;e++){var i=this._graph[t][e];i.distance=Number.POSITIVE_INFINITY,i.prev=null,i.neighbours=[],t>0&&i.neighbours.push(this._graph[t-1][e]),t<this._graph.length-1&&i.neighbours.push(this._graph[t+1][e]),e>0&&i.neighbours.push(this._graph[t][e-1]),e<this._graph[t].length-1&&i.neighbours.push(this._graph[t][e+1]),this._verts.push(i)}var n=this._source;this._verts[this._graph.length*n.x+n.y].distance=0}},{key:"findPaths",value:function(){for(var t=function(t,e){return e.distance-t.distance},e=[];this._verts.length>0;){this._verts.sort(t);var i=this._verts[this._verts.length-1];this._verts.pop();for(var n=0;n<i.neighbours.length;n++){var a=i.neighbours[n],s=i.distance+o.distance(i.x,i.y,a.x,a.y);s<a.distance&&(a.distance=s,a.prev=i,e.push(a))}}return this._paths=e,e}},{key:"retrievePathTo",value:function(t){for(var e=void 0,i=0;i<this._paths.length;i++)o.compareXY(t,this._paths[i])&&(e=this._paths[i]);if(!e)throw new Error("can't retrieve path, position not on graph");var n=[],a=function s(){n.push({x:e.x,y:e.y}),e.prev&&(e=e.prev,s())};return a(),n}},{key:"reset",value:function(){this.init()}},{key:"test",value:function(t){function e(t,i,n){var a=n[n.length-1];TweenMax.to(t,.5,{x:a.x*i,y:a.y*i+.5*i,ease:Power0.easeNone,onComplete:function(){n.pop(),n.length>0&&e(t,i,n)}})}var i=50,n=new PIXI.Container,a=15,s=o.matrix(a,a);n.x=.5*o.STAGE_WIDTH-i*(.5*a),t.addChild(n);for(var r=0;r<a;r++)for(var l=0;l<a;l++){var u=P3.createSprite(PIXI.Texture.WHITE,n);u.x=r*i,u.y=l*i,u.width=i-2,u.height=i-2,u.tint=14211288,s[r][l]={x:r,y:l}}this.graph=s,this.source=s[0][0];var h=performance.now();this.init();var _=this.findPaths(),d=performance.now();console.warn("found paths in : "+(d-h));var c=this.retrievePathTo({x:a-1,y:a-1});console.log(_),console.log(c);var p=P3.createSprite(PIXI.Texture.WHITE,n);p.anchor.set(.5),p.position.set(s[0][0].x,s[0][0].y),p.width=.5*i,p.height=.5*i,e(p,i,c)}},{key:"graph",set:function(t){this._graph=t}},{key:"source",set:function(t){this._source=t}},{key:"target",set:function(t){this._target=t}}]),t}();o.PathD=new u;var h=function(){function t(){a(this,t),this._graph=null,this._source=null,this._target=null,this._openList=[]}return s(t,[{key:"init",value:function(){if(!this._graph)throw new Error("must set graph before init");if(!this._source)throw new Error("must set source before init");for(var t=void 0,e=0;e<this._graph.length;e++)for(var i=0;i<this._graph[e].length;i++){var n=this._graph[e][i];n.neighbours=[],n.prev=null,e>0&&n.neighbours.push(this._graph[e-1][i]),e<this._graph.length-1&&n.neighbours.push(this._graph[e+1][i]),i>0&&n.neighbours.push(this._graph[e][i-1]),i<this._graph[e].length-1&&n.neighbours.push(this._graph[e][i+1]),o.compareXY({x:e,y:i},this._source)&&(n.visited=!0,t=n)}this._openList.reverse(),this._openList.push(t)}},{key:"find",value:function(){if(!this._target)throw new Error("must set target before performing BFS");for(var t=void 0,e=[];this._openList.length>0;){var i=this._openList[this._openList.length-1];if(this._openList.pop(),i.visited=!0,o.compareXY(i,this._target)){console.warn("found target"),t=i;break}for(var n=0;n<i.neighbours.length;n++){var a=i.neighbours[n];if(!a.visited){a.visited=!0,a.prev=i,this._openList.unshift(a);var s={start:i,end:a};e.push(s)}}}var r=[],l=t,u=function h(){r.push({x:l.x,y:l.y}),l.prev&&(l=l.prev,h())};return u(),r}},{key:"test",value:function(t){function e(t,i,n){var a=n[n.length-1];TweenMax.to(t,.5,{x:a.x*i,y:a.y*i+.5*i,ease:Power0.easeNone,onComplete:function(){n.pop(),n.length>0&&e(t,i,n)}})}var i=25,n=new PIXI.Container,a=25,s=o.matrix(a,a);n.x=.5*o.STAGE_WIDTH-i*(.5*a),t.addChild(n);for(var r=0;r<a;r++)for(var l=0;l<a;l++){var u=P3.createSprite(PIXI.Texture.WHITE,n);u.x=r*i,u.y=l*i,u.width=i-2,u.height=i-2,u.tint=14211288,s[r][l]={x:r,y:l}}this.graph=s,this.source=s[0][0],this.target={x:a-1,y:a-1};var h=performance.now();this.init();var _=this.find(),d=performance.now();console.warn("found paths in : "+(d-h)),console.log(_);var c=P3.createSprite(PIXI.Texture.WHITE,n);c.anchor.set(.5),c.position.set(s[0][0].x,s[0][0].y),c.width=.5*i,c.height=.5*i,e(c,i,_)}},{key:"graph",set:function(t){this._graph=t}},{key:"source",set:function(t){this._source=t}},{key:"target",set:function(t){this._target=t}}]),t}();o.PathBFS=new h,o.randBool=function(){return Math.random()>.5},o.toOneDecimalStr=function(t){var e=t.toFixed(1);return"0"==e[e.indexOf(".")+1]&&(e=e.substr(0,e.indexOf("."))),e},o.randomInt=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},o.heapPermutations=function(t){function e(t,e){var i=n[t];n[t]=n[e],n[e]=i}function i(t){if(1==t)a.push(n.slice());else for(var o=0;o!=t;++o)i(t-1),e(t%2?0:o,t-1)}var n=t.slice(),a=[];return i(n.length),a},o.getScreenPositionLeft=function(){return Math.max(0,.5*o.STAGE_WIDTH-.5*P3.View.width)},o.getScreenPositionRight=function(){return Math.min(o.STAGE_WIDTH,.5*o.STAGE_WIDTH+.5*P3.View.width)},o.distanceBetween=function(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))},o.angleBetween=function(t,e){return Math.atan2(e.x-t.x,e.y-t.y)},o.randomFloat=function(t,e){return Math.random()*(e-t)+t},o.midPointBtw=function(t,e){return{x:t.x+(e.x-t.x)/2,y:t.y+(e.y-t.y)/2}},o.hexToRgb=function(t){var e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null},o.findPositionInScene=function(t,e){for(var i=new PIXI.Point(t.x,t.y),n=t.parent;n!=e;)i.x+=n.x,i.y+=n.y,n=n.parent;return i},window.Common=o},{"./Application":2}],4:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){}Object.defineProperty(i,"__esModule",{value:!0});var o=t("./Common"),s=n(o);i["default"]=a,a.SCENE_ID_MAIN=0,a.SCENE_ID_GAME=1,a.SCENE_ID_IMAGE_SELECTION=2,a.SCENE_ID_GALLERY_SELECTION=3,a.LAYER_ID_FILL=0,a.LAYER_ID_DRAW=1,a.GALLERY_ID_DRAW_IT=0,a.GALLERY_ID_COLOUR_IT=1,a.ARR_COLOUR_IT_SPRITE_ID=["colour_image_1","colour_image_2","colour_image_3","colour_image_4","colour_image_5","colour_image_6","colour_image_7","colour_image_8","colour_image_9","colour_image_10"],a.ARR_DRAW_IT_SPRITE_ID=["draw_image_1","draw_image_2","draw_image_3","draw_image_4","draw_image_5","draw_image_6","draw_image_7_","draw_image_8","draw_image_9","draw_image_10"],a.TUT_EVENT={TOOL_BAR_HIDDEN:0,TOOL_BAR_VISIBLE:1,PALETTE_SELECTED:2,PALETTE_PANEL_HIDDEN:3,TOOL_SELECTED:4,CANVAS_DRAWN:5,CANVAS_VISIBLE:6,PALETTE_BUTTON_ENABLED:7,PALETTE_BUTTON_DISABLED:8,MENU_PANEL_SHOWN:9,MENU_PANEL_HIDDEN:10},a.TOOL={PENCIL:0,BRUSH:1,STAMP:2,BUCKET:3,INK_POT:4,SPRAY:5,ERASER:6},a.GALLERY_BORDER_TINT=[8900647,2000073],a.TEXTURE_BUTTON_BASE_ID="btns_colour_texture",a.TEXTURE_SPRITE_BASE_ID="texture_fill",a.CANVAS_HEIGHT=612,a.CANVAS_WIDTH=870,a.selectedGallery=null,a.selectedImageId=null,a.drawItTextId=null,a.createCanvasBg=function(){var t=.979,e="drawing";1===a.selectedGallery&&(e="colouring");var i=s["default"].assets.getTexture("canvas_"+e),n=new PIXI.Graphics;return n.beginFill(a.GALLERY_BORDER_TINT[a.selectedGallery],1),n.drawRoundedRect(.5*-i.width*t,.5*-i.height*t,i.width*t,i.height*t,30),n.endFill(),n},a.findColourCode=function(t){for(var e={r:0,g:0,b:1},i=s["default"].assets.getJSON("config").palettePanel.pages,n=0;n<i.length;++n){var a=i[n].indexOf(t);if(a!=-1){e.r=n,e.g=a;break}}return e}},{"./Common":3}],5:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e,i,n,a){var o=0|a,s=new PIXI.Text(t,{fontFamily:e,fontSize:i,fill:o});return s.anchor.x=.5,n&&n.addChild(s),s}function s(t,e,i,n){var a,o,s=n||"languages";return"ar"===g["default"].language?(o={font:e.size+" Noto Kufi Arabic",fill:e.fill,align:"center",padding:e.padding||0},e.wordWrapWidth&&(o.wordWrap=!0,o.wordWrapWidth=e.wordWrapWidth),e.stroke&&(o.stroke=e.stroke,o.strokeThickness=4),Object.assign(o,e),a=new PIXI.Text(g["default"].assets.getJSON(s)[t][g["default"].language],o)):(o={font:e.size+" Duality",fill:e.fill,align:"center",letterSpacing:4,padding:e.padding||0,lineJoin:"round"},e.wordWrapWidth&&(o.wordWrap=!0,o.wordWrapWidth=e.wordWrapWidth),e.stroke&&(o.stroke=e.stroke,o.strokeThickness=8),Object.assign(o,e),a=new PIXI.Text(g["default"].assets.getJSON(s)[t][g["default"].language],o)),a}function r(t,e){var i,n,a="languages";if("ar"===g["default"].language)n={font:e.size+" Noto Kufi Arabic",fill:e.fill,align:"center",padding:e.padding||0},e.wordWrapWidth&&(n.wordWrap=!0,n.wordWrapWidth=e.wordWrapWidth),e.stroke&&(n.stroke=e.stroke,n.strokeThickness=4),i=new PIXI.Text(g["default"].assets.getJSON(a)[t][g["default"].language],n);else{n={font:e.size+" Duality",fill:16777215,align:"center",letterSpacing:4,padding:e.padding||0,lineJoin:"round"},e.wordWrapWidth&&(n.wordWrap=!0,n.wordWrapWidth=e.wordWrapWidth),e.stroke&&(n.stroke=e.stroke,n.strokeThickness=8);var o=Object.assign({},n);delete o.fill;for(var s={"default":n,s0:Object.assign({fill:"#fff200"},o),s1:Object.assign({fill:"#00bff3"},o),s2:Object.assign({fill:"#00a650"},o),s3:Object.assign({fill:"#00bff3"},o),s4:Object.assign({fill:"#ff4b96"},o),s5:Object.assign({fill:"#ff2600"},o),s6:Object.assign({fill:"#f26522"},o),s7:Object.assign({fill:"#fff200"},o),s8:Object.assign({fill:"#00a650"},o),s9:Object.assign({fill:"#fff200"},o),s10:Object.assign({fill:"#00bff3"},o),s11:Object.assign({fill:"#00a650"},o),s12:Object.assign({fill:"#00bff3"},o),s13:Object.assign({fill:"#ff4b96"},o),s14:Object.assign({fill:"#f26522"},o),s15:Object.assign({fill:"#fff200"},o),s16:Object.assign({fill:"#00a650"},o),s17:Object.assign({fill:"#ff2600"},o),s18:Object.assign({fill:"#00a650"},o),s19:Object.assign({fill:"#00a650"},o),s20:Object.assign({fill:"#00a650"},o),s21:Object.assign({fill:"#00a650"},o),s22:Object.assign({fill:"#00a650"},o),s23:Object.assign({fill:"#00a650"},o)},r=g["default"].assets.getJSON(a)[t][g["default"].language],l=r.split(""),u="",h=0;h<l.length;h++)u+="<s"+h+">",u+=l[h],u+="</s"+h+">";i=new T["default"](u,s)}return i}function l(t,e){e=e||"primary_small";var i=new P3.ButtonStates(g["default"].assets.getTexture("btn_"+e+"_off"),g["default"].assets.getTexture("btn_"+e+"_over"),g["default"].assets.getTexture("btn_"+e+"_down"),g["default"].assets.getTexture("icon_"+t+"_off"));i.iconOver=g["default"].assets.getTexture("icon_"+t+"_over"),i.iconDown=g["default"].assets.getTexture("icon_"+t+"_down");var n=void 0;return"sound"===t?(i.iconAlt=g["default"].assets.getTexture("icon_mute_off"),i.iconOverAlt=g["default"].assets.getTexture("icon_mute_over"),i.iconDownAlt=g["default"].assets.getTexture("icon_mute_down"),n=new P3.MuteButton(i)):n=new P3.Button(i),n}function u(){}Object.defineProperty(i,"__esModule",{value:!0});var h=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),_=t("./Application"),d=n(_),c=t("./scenes/PreloaderScene"),p=n(c),f=t("./Common"),g=n(f),y=t("ismobilejs"),m=n(y),w=t("./pixi-multistyle-text"),T=n(w),x=function(){function t(e,i){a(this,t),this._width=e,this._height=i,this._preloader=null}return h(t,[{key:"init",value:function(t){g["default"].blankTexture=PIXI.Texture.WHITE,g["default"].assets=new P3.AssetManager,g["default"].audio=P3.Button.audio=new P3.AudioManager,g["default"].language=t,g["default"].assets.texture.bind(g["default"].assets),P3.Device={},P3.Device.isMobile=m["default"].any,g["default"].assets.getTexture=function(t){return g["default"].assets.texture(t)},g["default"].assets.getJSON=function(t){return g["default"].assets.json(t)},g["default"].assets.hasTexture=function(t){var e=!0;try{PIXI.Texture.fromFrame(t+".png")}catch(i){e=!1}return e};var e=!1,i={};i.holderId="game",i.width=this._width,i.height=this._height,i.portrait=e,i.aspectRatioFillHeight=!e,i.rotateImageUrl="./assets/images/localisation/rotate/rotate_screen_"+t+".jpg",i.rotateImageColor="#000000",PIXI.settings.RETINA_PREFIX=/\_(?=[^_]*$)(.+)x/,TweenMax.defaultOverwrite="none",TweenMax.ticker.fps(60);var n=new P3.View(i);n.signals.ready.addOnce(function(t){var e={};e.view=t,e.transparent=!1,e.antialias=!1,e.preserveDrawingBuffer=!1,e.resolution=1,g["default"].stage=new PIXI.Container,t.screencanvas=!0,document.onclick=function(){t.focus()};var i=PIXI.autoDetectRenderer(this._width,this._height,e);i.backgroundColor=0,g["default"].renderer=i,g["default"].isWebGL=i instanceof PIXI.WebGLRenderer;var n=new P3.SceneManager(i);n.updateAll=!0,g["default"].scene=n,g["default"].stage.addChild(n.view),PIXI.ticker.shared.add(function(t){window.P3.deltaTime=window.deltaTime=t/PIXI.settings.TARGET_FPMS/1e3,P3.Timestep.deltaTime=window.deltaTime,n.update(),i.render(g["default"].stage)},this),window.delay=function(t,e,i){TweenMax.delayedCall(e,t,[],i)},window.translate=function(t){var e=g["default"].config.strings[t];return e=e&&e[g["default"].language],"undefined"!=typeof e?e:t},this.loadPreloader()},this),n.signals.resize.add(this.onCanvasResize,this),g["default"].view=n}},{key:"loadPreloader",value:function(){var t=[{name:"ui_default_0_1x",url:"images/ui_default_0_1x.json"},{name:"ui_default_1_1x",url:"images/ui_default_1_1x.json"},{name:"preloader",url:"images/preloader_1x.json"},{name:"aeromaticslight_50",url:"fonts/aeromaticslight_50.xml"}],e=[];t.length?(g["default"].assets.addFiles(t,"assets/"),g["default"].assets.signals.complete.addOnce(function(){this.createConfig(),this.loadAssets()},this),g["default"].assets.load(),g["default"].audio.addSounds(e,[".mp3",".ogg"],"")):this.loadAssets()}},{key:"loadAssets",value:function(){var t=[{name:"languages",url:"data/languages.json"},{name:"config",url:"data/config.json"},{name:"draw_it",url:"data/draw_it.json"},{name:"ui_default_0_1x",url:"images/ui_default_0_1x.json"},{name:"ui_default_1_1x",url:"images/ui_default_1_1x.json"},{name:"game_title",url:"images/localisation/title/title_"+g["default"].language+".png"},{name:"colour_image_1",url:"images/outlines/colour_it/image_1.png"},{name:"colour_image_2",url:"images/outlines/colour_it/image_2.png"},{name:"colour_image_3",url:"images/outlines/colour_it/image_3.png"},{name:"colour_image_4",url:"images/outlines/colour_it/image_4.png"},{name:"colour_image_5",url:"images/outlines/colour_it/image_5.png"},{name:"colour_image_6",url:"images/outlines/colour_it/image_6.png"},{name:"colour_image_7",url:"images/outlines/colour_it/image_7.png"},{name:"colour_image_8",url:"images/outlines/colour_it/image_8.png"},{name:"colour_image_9",url:"images/outlines/colour_it/image_9.png"},{name:"colour_image_10",url:"images/outlines/colour_it/image_10.png"},{name:"draw_image_1",url:"images/outlines/draw_it/image_1.png"},{name:"draw_image_2",url:"images/outlines/draw_it/image_2.png"},{name:"draw_image_3",url:"images/outlines/draw_it/image_3.png"},{name:"draw_image_4",url:"images/outlines/draw_it/image_4.png"},{name:"draw_image_5",url:"images/outlines/draw_it/image_5.png"},{name:"draw_image_6",url:"images/outlines/draw_it/image_6.png"},{name:"draw_image_7",url:"images/outlines/draw_it/image_7.png"},{name:"draw_image_8",url:"images/outlines/draw_it/image_8.png"},{name:"draw_image_9",url:"images/outlines/draw_it/image_9.png"},{name:"draw_image_10",url:"images/outlines/draw_it/image_10.png"},{name:"splash_bg",url:"images/bg/splash_bg.jpg"},{name:"bg",url:"images/bg/bg_1x.jpg"},{name:"eraser_ps",url:"particles/particle_emitter_eraser_loop_00.json"},{name:"ink_ps",url:"particles/particle_emitter_ink_loop_00.json"},{name:"ink_splatter_ps",url:"particles/particle_emitter_inksplatter_loop_01.json"},{name:"brush_ps",url:"particles/particle_emitter_paintbrush_loop_00.json"},{name:"pencil_ps",url:"particles/particle_emitter_pencil_loop_00.json"},{name:"spray_ps",url:"particles/particle_emitter_spray_loop_00.json"},{name:"stamp_ps",url:"particles/particle_emitter_stamo_burst_00.json"},{name:"fill_ps",url:"particles/particle_paintfill_burst_00.json"},{name:"tutorial_hand",url:"images/tutorial_hand.json"}],e=["music_mainmenu_loop_00","music_ready_loop_012"],i=["sfx_ambient_desert_loop_00","sfx_drawer_hide_00","sfx_drawer_reveal_00","sfx_generic_colour_type_change_00","sfx_tool_eraser_loop_03","sfx_tool_eraser_select_00","sfx_tool_inkpot_select_00","sfx_tool_inkpot_use_splat_00","sfx_tool_magictape_select_00","sfx_tool_magictape_use_end_only_00","sfx_tool_magictape_use_loop_00","sfx_tool_paintbrush_dry_use_loop_00","sfx_tool_paintbrush_select_00","sfx_tool_paintbrush_wet_use_loop_00","sfx_tool_paintpot_fill_select_01","sfx_tool_paintpot_fill_use_02","sfx_tool_pencil_select_00","sfx_tool_pencil_use_loop_00","sfx_tool_spraycan_select_00","sfx_tool_spraycan_use_loop_00","sfx_tool_stamp_use_00","sfx_tool_stamps_select_00","sfx_tool_sticker_end_only","sfx_tool_sticker_place_00","sfx_tool_sticker_use_00","sfx_tool_stickers_select_00","sfx_tool_trashcan_confirm_00","sfx_tool_trashcan_select_00","sfx_tool_undo_step_back_00","sfx_ui_folder_save_00","sfx_ui_newpage_00","sfx_palette_select_00","sfx_palette_close_00","sfx_ui_carousel_swipe_00","sfx_ui_click_00","sfx_ui_rollover_00","sfx_btn_play_start_doorbell_00"];t.length?(this._preloader=new p["default"],g["default"].scene.add(this._preloader),g["default"].assets.addFiles(t,"assets/"),g["default"].assets.signals.progress.add(this.onLoadingProgress,this),g["default"].assets.signals.complete.addOnce(this.onLoadingCompleted,this),g["default"].assets.load(),g["default"].audio.addSounds(e,[".m4a",".ogg",".mp3"],"assets/audio/music/"),g["default"].audio.addSounds(i,[".m4a",".ogg",".mp3"],"assets/audio/sfx/")):this.startGame()}},{key:"createConfig",value:function(){var t=(g["default"].assets,{});g["default"].config=t}},{key:"startGame",value:function(){delay(function(){m["default"].any||d["default"].init()},1,this)}},{key:"onLoadingProgress",value:function(t){this._preloader.loaded=t.progress/100}},{key:"onLoadingCompleted",value:function(){g["default"].assets.signals.progress.removeAll(),g["default"].assets.signals.complete.removeAll(),g["default"].finishedLoading=!0,this._preloader.loaded=1,this.startGame(1)}},{key:"onCanvasResize",value:function(t){t&&(g["default"].renderer.resize(P3.View.width,P3.View.height),g["default"].scene&&g["default"].scene.resize())}}]),t}();i["default"]=x,window.Main=x,
P3.simpleText=o,P3.createText=s,P3.createMultiText=r,window.createButton=l,u.deltaTime=0,P3.Timestep=u},{"./Application":2,"./Common":3,"./pixi-multistyle-text":26,"./scenes/PreloaderScene":31,ismobilejs:1}],6:[function(t,e,i){"use strict";function n(){P3.AssetManager.instance;this.SAVE_NAME="customer_focus",this.SAVE_VERSION="0.0.18",this.SAVE_SEED="y5k0Eo6R177mUkb",this._isToolTutorial=!0,this._isDrawTutorial=!0,this._isPaletteTutorial=!0}t("./Common"),t("./CommonGame");e.exports=n,n.prototype.init=function(){window.localStorage[this.SAVE_NAME+"_"+this.SAVE_VERSION]?this.load():(this.reset(),this.save())},n.prototype.reset=function(){this._isToolTutorial=!0,this._isDrawTutorial=!0,this._isPaletteTutorial=!0},n.prototype.load=function(){var t=window.localStorage[this.SAVE_NAME+"_"+this.SAVE_VERSION];t=JSON.parse(t),this._isToolTutorial=t.isToolTutorial,this._isDrawTutorial=t.isDrawTutorial,this._isPaletteTutorial=t.isPaletteTutorial},n.prototype.save=function(){var t={};t.isToolTutorial=this._isToolTutorial,t.isDrawTutorial=this._isDrawTutorial,t.isPaletteTutorial=this._isPaletteTutorial;var e=JSON.stringify(t);t.hash=md5(e+this.SAVE_SEED),window.localStorage[this.SAVE_NAME+"_"+this.SAVE_VERSION]=JSON.stringify(t)},Object.defineProperty(n.prototype,"isToolTutorial",{get:function(){return this._isToolTutorial},set:function(t){this._isToolTutorial=t}}),Object.defineProperty(n.prototype,"isDrawTutorial",{get:function(){return this._isDrawTutorial},set:function(t){this._isDrawTutorial=t}}),Object.defineProperty(n.prototype,"isPaletteTutorial",{get:function(){return this._isPaletteTutorial},set:function(t){this._isPaletteTutorial=t}})},{"./Common":3,"./CommonGame":4}],7:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){this._drawLayer=null,this._magicBrush=null,this._colourBrush=null,this._paletteItem=null,this._curBrush=null,this._audio=null}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o),r=t("../ui/overlays/PalettePanel"),l=(n(r),t("./MagicBrush")),u=n(l),h=t("./ColourBrush"),_=n(h);i["default"]=a,a.prototype.constructor=a,a.prototype.init=function(t){this._drawLayer=t,this._magicBrush=new u["default"],this._magicBrush.init(t),this._colourBrush=new _["default"],this._colourBrush.init(t),this._curBrush=this._colourBrush,this._curBrush.colour=s["default"].assets.getJSON("config").palettePanel.pages[0][0],this._paletteItem=this._curBrush.colour,s["default"].game.scene.palettePanel.signals.onColourChanged.add(this._onColour_Changed,this)},a.prototype._stopAudio=function(){this._audio.howl.stop(this._audio.id),this._audio=null},a.prototype._draw=function(t,e){var i=s["default"].game.canvas.drawLayer.dynOutlineContext;i.beginPath(),i.strokeStyle="black",i.lineWidth=this._curBrush.LINE_THICKNESS,i.lineJoin="round",i.moveTo(t.x,t.y),i.lineTo(e.x,e.y),i.closePath(),i.stroke()},a.prototype._stopAudio=function(){this._audio.howl.stop(this._audio.id),this._audio=null},a.prototype.onDrawBegan=function(t){this._curBrush.onDrawBegan(t),this._draw(t,new PIXI.Point(t.x+.1,t.y+.1))},a.prototype.onDrawMoved=function(t,e){null==this._audio&&(this._audio=s["default"].audio.playSound("sfx_tool_paintbrush_wet_use_loop_00",{loop:!0})),TweenMax.killDelayedCallsTo(this._stopAudio),TweenMax.delayedCall(.25,this._stopAudio,null,this),this._curBrush.onDrawMoved(t,e),this._draw(t,e)},a.prototype.onDrawEnded=function(){TweenMax.killDelayedCallsTo(this._stopAudio),null!=this._audio&&this._stopAudio(),s["default"].game.canvas.drawLayer.dynOutlineData=s["default"].game.canvas.drawLayer.dynOutlineContext.getImageData(0,0,s["default"].game.canvas.WIDTH,s["default"].game.canvas.HEIGHT)},a.prototype._onColour_Changed=function(t){0==t.indexOf("#")?(this._curBrush=this._colourBrush,this._colourBrush.colour=t):(this._curBrush=this._magicBrush,this._magicBrush.textureId=t),this._paletteItem=t},Object.defineProperty(a.prototype,"paletteItem",{get:function(){return this._paletteItem}})},{"../Common":3,"../ui/overlays/PalettePanel":38,"./ColourBrush":9,"./MagicBrush":16}],8:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){PIXI.Container.call(this),this._fillLayer=null,this._drawLayer=null,this._bgSprite=null,this._borderSprite=null,this.WIDTH=l["default"].CANVAS_WIDTH,this.HEIGHT=l["default"].CANVAS_HEIGHT}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o),r=t("../CommonGame"),l=n(r),u=t("./MyGame"),h=(n(u),t("./FillLayer")),_=n(h),d=t("./DrawLayer"),c=n(d);i["default"]=a,a.prototype=Object.create(PIXI.Container.prototype),a.prototype.constructor=a,a.prototype.init=function(){this.addChild(l["default"].createCanvasBg()),this._bgSprite=new PIXI.Sprite(s["default"].blankTexture),this._bgSprite.anchor=new PIXI.Point(.5,.5),this._bgSprite.width=this.WIDTH,this._bgSprite.height=this.HEIGHT,this._bgSprite.tint=16777215,this.addChild(this._bgSprite),this._fillLayer=new _["default"],this._fillLayer.init(),this.addChild(this._fillLayer),this._drawLayer=new c["default"],this._drawLayer.init(),this.addChild(this._drawLayer);var t="drawing";1===l["default"].selectedGallery&&(t="colouring"),this._borderSprite=new PIXI.Sprite(s["default"].assets.getTexture("canvas_"+t)),this._borderSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._borderSprite),s["default"].game.hud.signals.onDrawModeChanged.add(this._onDrawMode_Changed,this),this._onDrawMode_Changed(l["default"].TOOL.PENCIL)},a.prototype.update=function(){this._fillLayer.update(),this._drawLayer.update()},a.prototype.animateIn=function(){this.y-=100,this.alpha=0,TweenMax.to(this,.25,{alpha:1,y:this.y+100,ease:Sine.easeOut,onComplete:function(){s["default"].game.scene.addTutorialEvent(l["default"].TUT_EVENT.CANVAS_VISIBLE)},onCompleteScope:this})},a.prototype.clear=function(){this._fillLayer.clear(),this._drawLayer.clear()},a.prototype._onDrawMode_Changed=function(t){t==l["default"].TOOL.PENCIL||t==l["default"].TOOL.BRUSH||t==l["default"].TOOL.SPRAY||t==l["default"].TOOL.STAMP||t==l["default"].TOOL.INK_POT||t==l["default"].TOOL.ERASER?(this._drawLayer.setEnabled(!0),this._fillLayer.setEnabled(!1)):t==l["default"].TOOL.BUCKET&&(this._drawLayer.setEnabled(!1),this._fillLayer.setEnabled(!0)),s["default"].audio.playSound("sfx_tool_paintbrush_select_00")},Object.defineProperty(a.prototype,"fillLayer",{get:function(){return this._fillLayer}}),Object.defineProperty(a.prototype,"drawLayer",{get:function(){return this._drawLayer}})},{"../Common":3,"../CommonGame":4,"./DrawLayer":11,"./FillLayer":13,"./MyGame":18}],9:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){this.LINE_THICKNESS=10,this._drawLayer=null,this._colour=null}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o);i["default"]=a,a.prototype.constructor=a,a.prototype.init=function(t){this._drawLayer=t},a.prototype._draw=function(t,e){for(var i=Math.round(s["default"].distanceBetween(t,e)),n=s["default"].angleBetween(t,e),a=Math.round(t.x+Math.sin(n)*i),o=Math.round(t.y+Math.cos(n)*i),r=0;r<i;r+=3){var l=Math.round(t.x+Math.sin(n)*r),u=Math.round(t.y+Math.cos(n)*r),h=this._drawLayer.context.createRadialGradient(a,o,this.LINE_THICKNESS,l,u,0),_=s["default"].hexToRgb(this._colour);h.addColorStop(0,"rgba( "+_.r+","+_.g+","+_.b+", 0 )"),h.addColorStop(1,"rgba( "+_.r+","+_.g+","+_.b+", 1 )"),this._drawLayer.context.fillStyle=h,this._drawLayer.context.fillRect(l-this.LINE_THICKNESS,u-this.LINE_THICKNESS,2*this.LINE_THICKNESS,2*this.LINE_THICKNESS),a=l,o=u}this._drawLayer.onContext_Changed()},a.prototype.onDrawBegan=function(t){this._draw(t,new PIXI.Point(t.x+.1,t.y+.1))},a.prototype.onDrawMoved=function(t,e){this._draw(t,e)},a.prototype.onDrawEnded=function(){},Object.defineProperty(a.prototype,"colour",{get:function(){return this._colour},set:function(t){this._colour=t}})},{"../Common":3}],10:[function(t,e,i){"use strict";function n(){this.LINE_THICKNESS=5,this._drawLayer=null,this._colour=null}t("../Common"),t("../CommonGame");e.exports=n,n.prototype.constructor=n,n.prototype.init=function(t){this._drawLayer=t},n.prototype._draw=function(t,e){this._drawLayer.context.beginPath(),this._drawLayer.context.strokeStyle=this._colour,this._drawLayer.context.lineWidth=this.LINE_THICKNESS,this._drawLayer.context.lineJoin="round",this._drawLayer.context.moveTo(t.x,t.y),this._drawLayer.context.lineTo(e.x,e.y),this._drawLayer.context.closePath(),this._drawLayer.context.stroke(),this._drawLayer.onContext_Changed()},n.prototype.onDrawBegan=function(t){this._draw(t,new PIXI.Point(t.x+.1,t.y+.1))},n.prototype.onDrawMoved=function(t,e){this._draw(t,e)},n.prototype.onDrawEnded=function(){},Object.defineProperty(n.prototype,"colour",{get:function(){return this._colour},set:function(t){this._colour=t}})},{"../Common":3,"../CommonGame":4}],11:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){PIXI.Container.call(this),this.STATE={IDLE:0,DRAWING:1},this._state=this.STATE.IDLE,this._canvas2d=null,this._context=null,this._dynOutline_c2d=null,this._dynOutlineContext=null,this._dynOutlineLayerData=null,this._pencil=null,this._brush=null,this._spray=null,this._stamp=null,this._inkPot=null,this._drawingTool=null,this._eraser=null,this._drawPS=null,this._layerSprite=null,this._lastInputLocalPosition=new PIXI.Point,this._updateInputLocalPosition=new PIXI.Point}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o),r=t("../CommonGame"),l=n(r),u=t("./Pencil"),h=n(u),_=t("./InkPot"),d=n(_),c=t("./Brush"),p=n(c),f=t("./Spray"),g=n(f),y=t("./Stamp"),m=n(y),w=t("./Eraser"),T=n(w);i["default"]=a,a.prototype=Object.create(PIXI.Container.prototype),a.prototype.constructor=a,a.prototype.init=function(){this._canvas2d=document.createElement("canvas"),this._canvas2d.width=s["default"].game.canvas.WIDTH,this._canvas2d.height=s["default"].game.canvas.HEIGHT,this._context=this._canvas2d.getContext("2d"),this._dynOutline_c2d=document.createElement("canvas"),this._dynOutline_c2d.width=s["default"].game.canvas.WIDTH,this._dynOutline_c2d.height=s["default"].game.canvas.HEIGHT,this._dynOutlineContext=this._dynOutline_c2d.getContext("2d"),this._dynOutlineContext.fillStyle="rgba(0, 0, 0, 0)",this._dynOutlineContext.fillRect(0,0,this._dynOutline_c2d.width,this._dynOutline_c2d.height),this._dynOutlineLayerData=this._dynOutlineContext.getImageData(0,0,this._dynOutline_c2d.width,this._dynOutline_c2d.height),this._pencil=new h["default"],this._pencil.init(this),this._brush=new p["default"],this._brush.init(this),this._spray=new g["default"],this._spray.init(this),this._stamp=new m["default"],this._stamp.init(this),this._inkPot=new d["default"],this._inkPot.init(this),this._eraser=new T["default"],this._eraser.init(this,s["default"].game.canvas.fillLayer),this._layerSprite=new PIXI.Sprite(PIXI.Texture.fromCanvas(this._canvas2d)),this._layerSprite.anchor=new PIXI.Point(.5,.5),this._layerSprite.interactive=!0,this._layerSprite.mousedown=this._layerSprite.touchstart=this._onDrawLayer_MouseDown.bind(this),this._layerSprite.mousemove=this._layerSprite.touchmove=this._onDrawLayer_MouseMove.bind(this),this._layerSprite.mouseup=this._layerSprite.touchend=this._onDrawLayer_MouseUp.bind(this),this._layerSprite.mouseupoutside=this._layerSprite.touchendoutside=this._onDrawLayer_MouseOut.bind(this),this.addChild(this._layerSprite),this._onDrawMode_Changed(l["default"].TOOL.PENCIL),s["default"].game.hud.signals.onDrawModeChanged.add(this._onDrawMode_Changed,this),s["default"].game.scene.palettePanel.signals.onColourChanged.add(this._onColour_Changed,this)},a.prototype.setEnabled=function(t){this._layerSprite.interactive=t},a.prototype.update=function(){this._drawPS.update(P3.Timestep.deltaTime),this._drawingTool!=this._spray&&this._drawPS.emit&&this._lastInputLocalPosition.x==this._updateInputLocalPosition.x&&this._lastInputLocalPosition.y==this._updateInputLocalPosition.y&&(this._drawPS.emit=!1),this._updateInputLocalPosition.x=this._lastInputLocalPosition.x,this._updateInputLocalPosition.y=this._lastInputLocalPosition.y},a.prototype.setLayerData=function(t,e){this._context.putImageData(t,0,0),this._dynOutlineLayerData=e,this._dynOutlineContext.putImageData(e,0,0),this._layerSprite.texture.update()},a.prototype.clear=function(){this._dynOutlineContext.clearRect(0,0,this._canvas2d.width,this._canvas2d.height),this._dynOutlineLayerData=this._dynOutlineContext.getImageData(0,0,this._dynOutline_c2d.width,this._dynOutline_c2d.height),this._context.clearRect(0,0,this._canvas2d.width,this._canvas2d.height),this._layerSprite.texture.update()},a.prototype.onContext_Changed=function(){s["default"].game.scene.addTutorialEvent(l["default"].TUT_EVENT.CANVAS_DRAWN),this._layerSprite.texture.update()},a.prototype._onDrawLayer_MouseDown=function(t){s["default"].game.undoManager.save();var e=t.data.getLocalPosition(this._layerSprite),i=new PIXI.Point;i.x=Math.floor(e.x+.5*s["default"].game.canvas.WIDTH),i.y=Math.floor(e.y+.5*s["default"].game.canvas.HEIGHT),this._lastInputLocalPosition=new PIXI.Point(i.x,i.y),this._state=this.STATE.DRAWING,this._drawingTool.onDrawBegan(i),this._drawingTool!=this._stamp&&this._drawingTool!=this._spray||(this._drawPS.spawnPos=new PIXI.Point(e.x,e.y),this._drawPS.emit=!0)},a.prototype._onDrawLayer_MouseMove=function(t){if(this._state==this.STATE.DRAWING){var e=t.data.getLocalPosition(this._layerSprite),i=new PIXI.Point;i.x=Math.floor(e.x+.5*s["default"].game.canvas.WIDTH),i.y=Math.floor(e.y+.5*s["default"].game.canvas.HEIGHT),this._drawingTool.onDrawMoved(this._lastInputLocalPosition,i),this._lastInputLocalPosition.x=i.x,this._lastInputLocalPosition.y=i.y,this._drawingTool!=this._stamp&&(this._drawPS.emit?this._drawPS.updateSpawnPos(e.x,e.y):(this._drawPS.resetPositionTracking(),this._drawPS.spawnPos=new PIXI.Point(e.x,e.y),this._drawPS.emit=!0))}},a.prototype._onDrawLayer_MouseUp=function(t){this._state==this.STATE.DRAWING&&(this._drawingTool.onDrawEnded(),this._state=this.STATE.IDLE,this._drawingTool!=this._stamp&&(this._drawPS.emit=!1))},a.prototype._onDrawLayer_MouseOut=function(t){this._state==this.STATE.DRAWING&&(this._drawingTool.onDrawEnded(),this._state=this.STATE.IDLE),this._drawPS.emit=!1},a.prototype._onThickness_Changed=function(t){this._thickness=this.BASE_LINE_THICKNESS*(t+1)},a.prototype._onColour_Changed=function(t){if(this._drawingTool==this._pencil||this._drawingTool==this._brush||this._drawingTool==this._spray||this._drawingTool==this._inkPot){var e={r:255,g:255,b:255};0==this._drawingTool.paletteItem.indexOf("#")&&(e=s["default"].hexToRgb(this._drawingTool.paletteItem)),this._drawPS.startColor=[e.r,e.g,e.b],this._drawPS.endColor=this._drawPS.startColor}},a.prototype._onDrawMode_Changed=function(t){var e={r:255,g:255,b:255};switch(t){case l["default"].TOOL.PENCIL:this._drawingTool=this._pencil,0==this._drawingTool.paletteItem.indexOf("#")&&(e=s["default"].hexToRgb(this._drawingTool.paletteItem)),this._drawPS=new PIXI.particles.Emitter(this,[s["default"].assets.getTexture("particle_draw")],s["default"].assets.getJSON("pencil_ps")),this._drawPS.emitterLifetime=-1;break;case l["default"].TOOL.BRUSH:this._drawingTool=this._brush,0==this._drawingTool.paletteItem.indexOf("#")&&(e=s["default"].hexToRgb(this._drawingTool.paletteItem)),this._drawPS=new PIXI.particles.Emitter(this,[s["default"].assets.getTexture("particle_paintbrush")],s["default"].assets.getJSON("brush_ps")),this._drawPS.emitterLifetime=-1;break;case l["default"].TOOL.SPRAY:this._drawingTool=this._spray,0==this._drawingTool.paletteItem.indexOf("#")&&(e=s["default"].hexToRgb(this._drawingTool.paletteItem)),this._drawPS=new PIXI.particles.Emitter(this,[s["default"].assets.getTexture("particle_spray")],s["default"].assets.getJSON("spray_ps")),this._drawPS.emitterLifetime=-1;break;case l["default"].TOOL.STAMP:this._drawingTool=this._stamp,e=s["default"].hexToRgb("#ffe400"),this._drawPS=new PIXI.particles.Emitter(this,[s["default"].assets.getTexture("particle_stamp")],s["default"].assets.getJSON("stamp_ps")),this._drawPS.emitterLifetime=.1;break;case l["default"].TOOL.INK_POT:this._drawingTool=this._inkPot,0==this._drawingTool.paletteItem.indexOf("#")&&(e=s["default"].hexToRgb(this._drawingTool.paletteItem)),this._drawPS=new PIXI.particles.Emitter(this,[s["default"].assets.getTexture("particle_ink_splatter")],s["default"].assets.getJSON("ink_splatter_ps")),this._drawPS.emitterLifetime=-1;break;case l["default"].TOOL.ERASER:this._drawingTool=this._eraser,e=s["default"].hexToRgb("#fd93bd"),this._drawPS=new PIXI.particles.Emitter(this,[s["default"].assets.getTexture("particle_erase")],s["default"].assets.getJSON("eraser_ps")),this._drawPS.emitterLifetime=-1}this._drawPS.startColor=[e.r,e.g,e.b],this._drawPS.endColor=this._drawPS.startColor,this._drawPS.emit=!1},Object.defineProperty(a.prototype,"context",{get:function(){return this._context}}),Object.defineProperty(a.prototype,"dynOutlineContext",{get:function(){return this._dynOutlineContext}}),Object.defineProperty(a.prototype,"state",{get:function(){return this._state}}),Object.defineProperty(a.prototype,"drawingTool",{get:function(){return this._drawingTool}}),Object.defineProperty(a.prototype,"dynOutlineData",{get:function(){return this._dynOutlineLayerData},set:function(t){return this._dynOutlineLayerData=t}})},{"../Common":3,"../CommonGame":4,"./Brush":7,"./Eraser":12,"./InkPot":15,"./Pencil":20,"./Spray":21,"./Stamp":22}],12:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){this.LINE_THICKNESS=10,this._drawLayer=null,this._fillLayer=null,this._audio=null,this._arrCanvasContext=[]}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o);i["default"]=a,a.prototype.constructor=a,a.prototype.init=function(t,e){this._drawLayer=t,this._fillLayer=e,this._arrCanvasContext.push(this._drawLayer.context),this._arrCanvasContext.push(this._fillLayer._colourContext),this._arrCanvasContext.push(this._fillLayer._colourCodeContext)},a.prototype._draw=function(t,e,i){t.beginPath(),t.lineWidth=this.LINE_THICKNESS,t.lineJoin="round",t.moveTo(e.x,e.y),t.lineTo(i.x,i.y),t.closePath(),t.stroke()},a.prototype._stopAudio=function(){this._audio.howl.stop(this._audio.id),this._audio=null},a.prototype.onDrawBegan=function(t){var e=!0,i=!1,n=void 0;try{for(var a,o=this._arrCanvasContext[Symbol.iterator]();!(e=(a=o.next()).done);e=!0){var r=a.value;r.save(),r.globalCompositeOperation="destination-out",r.strokeStyle="rgba( 255, 255, 255, 255 )",this._draw(r,t,new PIXI.Point(t.x+.1,t.y+.1))}}catch(l){i=!0,n=l}finally{try{!e&&o["return"]&&o["return"]()}finally{if(i)throw n}}var u=s["default"].game.canvas.drawLayer.dynOutlineContext;u.save(),u.globalCompositeOperation="destination-out",u.beginPath(),u.strokeStyle="rgba( 255, 255, 255, 255 )",u.lineWidth=this.LINE_THICKNESS,u.lineJoin="round",u.moveTo(t.x,t.y),u.lineTo(t.x+.1,t.y+.1),u.closePath(),u.stroke(),this._drawLayer.onContext_Changed(),this._fillLayer.onContext_Changed()},a.prototype.onDrawMoved=function(t,e){null==this._audio&&(this._audio=s["default"].audio.playSound("sfx_tool_eraser_loop_03",{loop:!0})),TweenMax.killDelayedCallsTo(this._stopAudio),TweenMax.delayedCall(.25,this._stopAudio,null,this),this._lastPosition=s["default"].renderer.plugins.interaction.mouse.global;var i=!0,n=!1,a=void 0;try{for(var o,r=this._arrCanvasContext[Symbol.iterator]();!(i=(o=r.next()).done);i=!0){var l=o.value;this._draw(l,t,e)}}catch(u){n=!0,a=u}finally{try{!i&&r["return"]&&r["return"]()}finally{if(n)throw a}}this._drawLayer.onContext_Changed(),this._fillLayer.onContext_Changed();var h=s["default"].game.canvas.drawLayer.dynOutlineContext;h.beginPath(),h.lineWidth=this.LINE_THICKNESS,h.lineJoin="round",h.moveTo(t.x,t.y),h.lineTo(e.x,e.y),h.closePath(),h.stroke()},a.prototype.onDrawEnded=function(){TweenMax.killDelayedCallsTo(this._stopAudio),null!=this._audio&&this._stopAudio();var t=!0,e=!1,i=void 0;try{for(var n,a=this._arrCanvasContext[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var o=n.value;o.restore()}}catch(r){e=!0,i=r}finally{try{!t&&a["return"]&&a["return"]()}finally{if(e)throw i}}var l=s["default"].game.canvas.drawLayer.dynOutlineContext;l.restore(),s["default"].game.canvas.drawLayer._dynOutlineLayerData=l.getImageData(0,0,s["default"].game.canvas.WIDTH,s["default"].game.canvas.HEIGHT),this._fillLayer.updateContextData()}},{"../Common":3}],13:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){PIXI.Container.call(this),this.STATE={IDLE:0,FILL_ANIM:1},this._state=this.STATE.IDLE,this._paletteItem=null,this._colour_c2d=null,this._colourCode_c2d=null,this._fillAnim_c2d=null,this._colourContext=null,this._colourCodeContext=null,this._fillAnimContext=null,this._curColour=null,this._outlineImage=new Image,this._fillAnimLayerData=null,this._colourLayerData=null,this._outlineLayerData=null,this._colourCodeLayerData=null,this._colourLayerSprite=null,this._fillAnimLayerSprite=null,this._outlineLayerSprite=null,this._fillAnimMask=null,this._lastInputGlobalPosition=new PIXI.Point,this._fillAnimRadius=0,this._fillAnimMaxDeltaX=0,this._fillAnimMaxDeltaY=0,this._textureStartPixelPos=-1,this._drawPS=null}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o),r=t("../CommonGame"),l=n(r),u=t("../ui/overlays/PalettePanel");n(u);i["default"]=a,a.prototype=Object.create(PIXI.Container.prototype),a.prototype.constructor=a,a.prototype.init=function(){this._colour_c2d=document.createElement("canvas"),this._colour_c2d.width=s["default"].game.canvas.WIDTH,this._colour_c2d.height=s["default"].game.canvas.HEIGHT,this._colourCode_c2d=document.createElement("canvas"),this._colourCode_c2d.width=s["default"].game.canvas.WIDTH,this._colourCode_c2d.height=s["default"].game.canvas.HEIGHT,this._fillAnim_c2d=document.createElement("canvas"),this._fillAnim_c2d.width=s["default"].game.canvas.WIDTH,this._fillAnim_c2d.height=s["default"].game.canvas.HEIGHT,this._colourContext=this._colour_c2d.getContext("2d"),this._colourCodeContext=this._colourCode_c2d.getContext("2d"),this._fillAnimContext=this._fillAnim_c2d.getContext("2d"),this._colourLayerSprite=new PIXI.Sprite(PIXI.Texture.fromCanvas(this._colour_c2d)),this._colourLayerSprite.anchor=new PIXI.Point(.5,.5),this._colourLayerSprite.interactive=!0,this._colourLayerSprite.click=this._colourLayerSprite.touchend=this._onFillLayer_Click.bind(this),this.addChild(this._colourLayerSprite),this._fillAnimMask=new PIXI.Graphics,this.addChild(this._fillAnimMask),this._fillAnimLayerSprite=new PIXI.Sprite(PIXI.Texture.fromCanvas(this._fillAnim_c2d)),this._fillAnimLayerSprite.anchor=new PIXI.Point(.5,.5),this._fillAnimLayerSprite.mask=this._fillAnimMask,this.addChild(this._fillAnimLayerSprite);var t=PIXI.Texture.fromImage("assets/images/outlines/"+(l["default"].selectedGallery==l["default"].GALLERY_ID_DRAW_IT?"draw_it/":"colour_it/")+l["default"].selectedImageId+".png");this._outlineLayerSprite=new PIXI.Sprite(t);var e=new PIXI.Texture(t,new PIXI.Rectangle(.5*t.width-.5*s["default"].game.canvas.WIDTH,.5*t.height-.5*s["default"].game.canvas.HEIGHT,s["default"].game.canvas.WIDTH,s["default"].game.canvas.HEIGHT));this._outlineLayerSprite.setTexture(e),this._outlineLayerSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._outlineLayerSprite),this._colourContext.clearRect(0,0,this._colour_c2d.width,this._colour_c2d.height),this._fillAnimLayerData=this._fillAnimContext.getImageData(0,0,this._fillAnim_c2d.width,this._fillAnim_c2d.height),this._colourLayerData=this._colourContext.getImageData(0,0,this._colour_c2d.width,this._colour_c2d.height),this._colourCodeLayerData=this._colourContext.getImageData(0,0,this._colour_c2d.width,this._colour_c2d.height),this._outlineImage.src="assets/images/outlines/"+(l["default"].selectedGallery==l["default"].GALLERY_ID_DRAW_IT?"draw_it/":"colour_it/")+l["default"].selectedImageId+".png",this._colourContext.drawImage(this._outlineImage,.5*this._colourLayerSprite.width-.5*this._outlineImage.width*this._outlineLayerSprite.scale.x,.5*this._colourLayerSprite.height-.5*this._outlineImage.height*this._outlineLayerSprite.scale.y,this._outlineImage.width*this._outlineLayerSprite.scale.x,this._outlineImage.height*this._outlineLayerSprite.scale.y),this._outlineLayerData=this._colourContext.getImageData(0,0,this._colour_c2d.width,this._colour_c2d.height),this._colourContext.clearRect(0,0,this._colourContext.canvas.width,this._colourContext.canvas.height),this._colourContext.clearRect(0,0,this._colour_c2d.width,this._colour_c2d.height),this._onColour_Changed(s["default"].assets.getJSON("config").palettePanel.pages[0][0],0,0),this._drawPS=new PIXI.particles.Emitter(this._outlineLayerSprite,[s["default"].assets.getTexture("particle_paintfill")],s["default"].assets.getJSON("fill_ps")),this._drawPS.emit=!1,this._drawPS.emitterLifetime=.1,s["default"].game.scene.palettePanel.signals.onColourChanged.add(this._onColour_Changed,this)},a.prototype.update=function(){this._drawPS.update(P3.Timestep.deltaTime)},a.prototype.setEnabled=function(t){this._colourLayerSprite.interactive=t},a.prototype.setLayerData=function(t,e){this._colourCodeLayerData=e,this._colourCodeContext.putImageData(e,0,0),this._colourLayerData=t,this._colourContext.putImageData(t,0,0),this._colourLayerSprite.texture.update()},a.prototype.clear=function(){this._colourContext.clearRect(0,0,this._colour_c2d.width,this._colour_c2d.height),this._colourLayerData=this._colourContext.getImageData(0,0,this._colour_c2d.width,this._colour_c2d.height),this._colourCodeLayerData=this._colourContext.getImageData(0,0,this._colour_c2d.width,this._colour_c2d.height),this._colourLayerSprite.texture.update()},a.prototype.updateContextData=function(){this._colourCodeLayerData=this._colourCodeContext.getImageData(0,0,this._colourCode_c2d.width,this._colourCode_c2d.height),this._colourLayerData=this._colourContext.getImageData(0,0,this._colour_c2d.width,this._colour_c2d.height)},a.prototype._fillAt=function(t,e){var i=4*(e*this._colour_c2d.width+t),n=this._colourCodeLayerData.data[i],a=this._colourCodeLayerData.data[i+1],o=this._colourCodeLayerData.data[i+2],r=this._colourCodeLayerData.data[i+3];if(!(n==this._curColour.colourCode.r&&a==this._curColour.colourCode.g&&o==this._curColour.colourCode.b||(r=this._outlineLayerData.data[i+3],r>0||(r=s["default"].game.canvas.drawLayer.dynOutlineData.data[i+3],r>0)))){this._textureStartPixelPos=i,this._floodFill(t,e),this._colourContext.clearRect(0,0,this._colourContext.canvas.width,this._colourContext.canvas.height),this._colourContext.putImageData(this._colourLayerData,0,0);var l=Math.sqrt(Math.pow(this._fillAnimMaxDeltaX,2)+Math.pow(this._fillAnimMaxDeltaY,2));TweenMax.to(this,l/600,{_fillAnimRadius:l,ease:Linear.easeInOut,onComplete:function(){this._updateFillAnimMask(),this._fillAnimMaxDeltaX=0,this._fillAnimMaxDeltaY=0,this._fillAnimRadius=0,this._state=this.STATE.IDLE,this._colourLayerSprite.texture.update(),this._fillAnimMask.clear(),this._fillAnimContext.clearRect(0,0,this._fillAnim_c2d.width,this._fillAnim_c2d.height),this._fillAnimLayerData=this._fillAnimContext.getImageData(0,0,this._fillAnim_c2d.width,this._fillAnim_c2d.height),this._fillAnimLayerSprite.texture.update()},onCompleteScope:this,onUpdate:function(){this._updateFillAnimMask()},onUpdateScope:this}),this._fillAnimContext.putImageData(this._fillAnimLayerData,0,0),this._fillAnimLayerSprite.texture.update(),this._state=this.STATE.FILL_ANIM}},a.prototype._floodFill=function(t,e){for(var i,n,a,o,r,l,u=0,h=0,_=s["default"].game.canvas.WIDTH-1,d=s["default"].game.canvas.HEIGHT-1,c=[[t,e]];c.length;){i=c.pop(),n=i[0],a=i[1];var p=n-t,f=a-e;for(Math.abs(f)>this._fillAnimMaxDeltaY&&(this._fillAnimMaxDeltaY=Math.abs(f)),Math.abs(p)>this._fillAnimMaxDeltaX&&(this._fillAnimMaxDeltaX=Math.abs(p)),o=4*(a*this._colour_c2d.width+n);a>=h&&this._isPixelToFill(o);)a-=1,o-=4*this._colour_c2d.width;for(o+=4*this._colour_c2d.width,a+=1,r=!1,l=!1;a<=d&&this._isPixelToFill(o);)this._paintPixel(o),n>u&&(this._isPixelToFill(o-4)?r||(c.push([n-1,a]),r=!0):r&&(r=!1)),n<_&&(this._isPixelToFill(o+4)?l||(c.push([n+1,a]),l=!0):l&&(l=!1)),a+=1,o+=4*this._colour_c2d.width,f=a-e,Math.abs(f)>this._fillAnimMaxDeltaY&&(this._fillAnimMaxDeltaY=Math.abs(f))}},a.prototype._isPixelToFill=function(t){var e=!0,i=this._outlineLayerData.data[t],n=this._outlineLayerData.data[t+1],a=this._outlineLayerData.data[t+2],o=this._outlineLayerData.data[t+3];return e=o<=127.5,e&&(i=this._colourCodeLayerData.data[t],n=this._colourCodeLayerData.data[t+1],a=this._colourCodeLayerData.data[t+2],e=i!=this._curColour.colourCode.r||n!=this._curColour.colourCode.g||a!=this._curColour.colourCode.b),e&&(o=s["default"].game.canvas.drawLayer.dynOutlineData.data[t+3],e=o<255),e},a.prototype._paintPixel=function(t){var e,i,n,a;if(this._curColour.isTexture){var o=Math.floor(t/4/this._colour_c2d.width)-Math.floor(this._textureStartPixelPos/4/this._colour_c2d.width),s=Math.floor(t/4%this._colour_c2d.width)-Math.floor(this._textureStartPixelPos/4%this._colour_c2d.width),r=o%this._curColour.data.height;r<0&&(r+=this._curColour.data.height);var l=s%this._curColour.data.height;l<0&&(l+=this._curColour.data.height);var u=4*(this._curColour.data.height*r+l);e=this._curColour.data.data[u],i=this._curColour.data.data[u+1],n=this._curColour.data.data[u+2],a=void 0!==this._curColour.data.data[u+3]?this._curColour.data.data[u+3]:255}else e=this._curColour.r,i=this._curColour.g,n=this._curColour.b,a=void 0!==this._curColour.a?this._curColour.a:255;this._colourLayerData.data[t]=e,this._colourLayerData.data[t+1]=i,this._colourLayerData.data[t+2]=n,this._colourLayerData.data[t+3]=a,this._fillAnimLayerData.data[t]=e,this._fillAnimLayerData.data[t+1]=i,this._fillAnimLayerData.data[t+2]=n,this._fillAnimLayerData.data[t+3]=a,this._colourCodeLayerData.data[t]=this._curColour.colourCode.r,this._colourCodeLayerData.data[t+1]=this._curColour.colourCode.g,this._colourCodeLayerData.data[t+2]=this._curColour.colourCode.b,this._colourCodeLayerData.data[t+3]=255},a.prototype._updateFillAnimMask=function(){this._fillAnimMask.clear(),this._fillAnimMask.beginFill(),this._fillAnimMask.drawCircle(this._lastInputGlobalPosition.x,this._lastInputGlobalPosition.y,this._fillAnimRadius),this._fillAnimMask.endFill()},a.prototype.onContext_Changed=function(){this._colourLayerSprite.texture.update()},a.prototype._onColour_Changed=function(t,e,i){if(this._paletteItem=t,0==t.indexOf("#")){var n=s["default"].hexToRgb(t);this._curColour={r:n.r,g:n.g,b:n.b,isTexture:!1,colourCode:{r:e,g:i,b:1}}}else{var a=s["default"].assets.getTexture(t),o=a.frame,r=document.createElement("canvas");r.width=o.width,r.height=o.height;var l=r.getContext("2d");l.drawImage(a.baseTexture.source,o.x*s["default"].main.assetRes,o.y*s["default"].main.assetRes,o.width*s["default"].main.assetRes,o.height*s["default"].main.assetRes,0,0,o.width,o.height),this._curColour={data:l.getImageData(0,0,r.width,r.height),isTexture:!0,colourCode:{r:e,g:i,b:1}}}},a.prototype._onFillLayer_Click=function(t){if(this._state!=this.STATE.FILL_ANIM){this._colourCodeContext.putImageData(this._colourCodeLayerData,0,0),s["default"].game.undoManager.save();var e=t.data.getLocalPosition(this._colourLayerSprite),i=new PIXI.Point;i.x=Math.floor(e.x+.5*s["default"].game.canvas.WIDTH),i.y=Math.floor(e.y+.5*s["default"].game.canvas.HEIGHT),this._fillAt(Math.floor(i.x),Math.floor(i.y)),this._lastInputGlobalPosition=new PIXI.Point(t.data.global.x-s["default"].game.scene.x-s["default"].game.canvas.x,t.data.global.y-s["default"].game.canvas.y);var n={r:255,g:255,b:255};0==this._paletteItem.indexOf("#")&&(n=s["default"].hexToRgb(this._paletteItem)),this._drawPS.startColor=[n.r,n.g,n.b],this._drawPS.endColor=this._drawPS.startColor,this._drawPS.spawnPos=new PIXI.Point(e.x,e.y),this._drawPS.emit=!0,s["default"].audio.playSound("sfx_tool_paintpot_fill_use_02"),s["default"].game.scene.addTutorialEvent(l["default"].TUT_EVENT.CANVAS_DRAWN)}},Object.defineProperty(a.prototype,"colourContext",{
get:function(){return this._colourContext}}),Object.defineProperty(a.prototype,"colourCodeContext",{get:function(){return this._colourCodeContext}}),Object.defineProperty(a.prototype,"state",{get:function(){return this._state}}),Object.defineProperty(a.prototype,"paletteItem",{get:function(){return this._paletteItem}})},{"../Common":3,"../CommonGame":4,"../ui/overlays/PalettePanel":38}],14:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../Common"),u=n(l),h=t("../CommonGame"),_=n(h),d=t("../ui/overlays/PalettePanel"),c=(n(d),t("./PaletteButton")),p=n(c),f=t("../shaders/OutlineFilter"),g=n(f),y=function(t){function e(){a(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._leftBarContainer=null,t._rightBarContainer=null,t._leftBarSprite=null,t._rightBarSprite=null,t._menuBtn=null,t._undoBtn=null,t._lastToolBtn=null,t._pencilButton=null,t._brushButton=null,t._bucketButton=null,t._stampButton=null,t._inkPotButton=null,t._sprayButton=null,t._eraserButton=null,t._paletteButton=null,t._drawItText=null,t._palettePanel=null,t._drawMode=_["default"].TOOL.PENCIL,t.signals={},t.signals.onMenuClick=new signals.Signal,t.signals.onPaletteClick=new signals.Signal,t.signals.onDrawModeChanged=new signals.Signal,t}return s(e,t),r(e,[{key:"init",value:function(){console.assert(null!=u["default"].game.scene.palettePanel,"Initialization failed: Common.game.scene.palettePanel is null."),this._palettePanel=u["default"].game.scene.palettePanel,this._leftBarContainer=new PIXI.Container,this._leftBarContainer.anchor=new PIXI.Point(0,.5),this._leftBarContainer.x=u["default"].getScreenPositionLeft()-this.x,this.addChild(this._leftBarContainer),this._leftBarSprite=new PIXI.Sprite(u["default"].assets.getTexture("panel_l")),this._leftBarSprite.anchor=new PIXI.Point(0,.5),this._leftBarContainer.addChild(this._leftBarSprite),this._rightBarContainer=new PIXI.Container,this._rightBarContainer.anchor=new PIXI.Point(0,.5),this._rightBarContainer.x=u["default"].getScreenPositionRight()-this.x,this.addChild(this._rightBarContainer),this._rightBarSprite=new PIXI.Sprite(u["default"].assets.getTexture("panel_r")),this._rightBarSprite.anchor=new PIXI.Point(1,.5),this._rightBarContainer.addChild(this._rightBarSprite);var t=90;this._menuBtn=createButton("menu"),this._menuBtn.anchor=new PIXI.Point(.5,.5),this._menuBtn.y=-280,this._menuBtn.x=t,this._menuBtn.overSoundName="sfx_ui_rollover_00",this._menuBtn.downSoundName="sfx_ui_click_00",this._menuBtn.signals.click.add(this._onMenuButton_Click,this),this._leftBarSprite.addChild(this._menuBtn);var e=new P3.ButtonStates(u["default"].assets.getTexture("icon_undo"),u["default"].assets.getTexture("icon_undo"),u["default"].assets.getTexture("icon_undo"));if(this._undoBtn=new P3.Button(e),this._undoBtn.anchor=new PIXI.Point(.5,.5),this._undoBtn.y=-280,this._undoBtn.x=-t,this._undoBtn.signals.click.add(this._onUndoButton_Click,this),this._rightBarSprite.addChild(this._undoBtn),this._undoBtn.interactive=!1,this._undoBtn.alpha=.5,this._paletteButton=new p["default"],this._paletteButton.init(),this._paletteButton.anchor=new PIXI.Point(.5,.5),this._paletteButton.y=260,this._paletteButton.x=t,this._paletteButton.scale.x=-1,this._paletteButton.signals.onClick.add(this._onPaletteBtn_Click,this),this._leftBarSprite.addChild(this._paletteButton),this._paletteButton.setup(u["default"].assets.getJSON("config").palettePanel.pages[0][0],_["default"].TOOL.PENCIL),e=new P3.ButtonStates(u["default"].assets.getTexture("icon_pencil"),u["default"].assets.getTexture("icon_pencil"),u["default"].assets.getTexture("icon_pencil")),this._pencilButton=new P3.Button(e),this._pencilButton.anchor=new PIXI.Point(.5,.5),this._pencilButton.y=110,this._pencilButton.x=t,this._pencilButton.drawMode=_["default"].TOOL.PENCIL,this._pencilButton.signals.click.add(this._onDrawMode_Changed,this),this._leftBarSprite.addChild(this._pencilButton),e=new P3.ButtonStates(u["default"].assets.getTexture("icon_brush"),u["default"].assets.getTexture("icon_brush"),u["default"].assets.getTexture("icon_brush")),this._brushButton=new P3.Button(e),this._brushButton.anchor=new PIXI.Point(.5,.5),this._brushButton.y=-10,this._brushButton.x=t,this._brushButton.drawMode=_["default"].TOOL.BRUSH,this._brushButton.signals.click.add(this._onDrawMode_Changed,this),this._leftBarSprite.addChild(this._brushButton),e=new P3.ButtonStates(u["default"].assets.getTexture("icon_fill"),u["default"].assets.getTexture("icon_fill"),u["default"].assets.getTexture("icon_fill")),this._bucketButton=new P3.Button(e),this._bucketButton.anchor=new PIXI.Point(.5,.5),this._bucketButton.y=-130,this._bucketButton.x=t,this._bucketButton.drawMode=_["default"].TOOL.BUCKET,this._bucketButton.signals.click.add(this._onDrawMode_Changed,this),this._leftBarSprite.addChild(this._bucketButton),e=new P3.ButtonStates(u["default"].assets.getTexture("icon_stamp"),u["default"].assets.getTexture("icon_stamp"),u["default"].assets.getTexture("icon_stamp")),this._stampButton=new P3.Button(e),this._stampButton.anchor=new PIXI.Point(.5,.5),this._stampButton.scale.x=-1,this._stampButton.defaultScale.x=this._stampButton.scale.x,this._stampButton.y=230,this._stampButton.x=-t,this._stampButton.drawMode=_["default"].TOOL.STAMP,this._stampButton.signals.click.add(this._onDrawMode_Changed,this),this._rightBarSprite.addChild(this._stampButton),e=new P3.ButtonStates(u["default"].assets.getTexture("icon_ink"),u["default"].assets.getTexture("icon_ink"),u["default"].assets.getTexture("icon_ink")),this._inkPotButton=new P3.Button(e),this._inkPotButton.anchor=new PIXI.Point(.5,.5),this._inkPotButton.y=110,this._inkPotButton.x=-t,this._inkPotButton.drawMode=_["default"].TOOL.INK_POT,this._inkPotButton.signals.click.add(this._onDrawMode_Changed,this),this._rightBarSprite.addChild(this._inkPotButton),e=new P3.ButtonStates(u["default"].assets.getTexture("icon_spray"),u["default"].assets.getTexture("icon_spray"),u["default"].assets.getTexture("icon_spray")),this._sprayButton=new P3.Button(e),this._sprayButton.anchor=new PIXI.Point(.5,.5),this._sprayButton.y=-10,this._sprayButton.x=-t,this._sprayButton.drawMode=_["default"].TOOL.SPRAY,this._sprayButton.signals.click.add(this._onDrawMode_Changed,this),this._rightBarSprite.addChild(this._sprayButton),e=new P3.ButtonStates(u["default"].assets.getTexture("icon_eraser"),u["default"].assets.getTexture("icon_eraser"),u["default"].assets.getTexture("icon_eraser")),this._eraserButton=new P3.Button(e),this._eraserButton.anchor=new PIXI.Point(.5,.5),this._eraserButton.y=-130,this._eraserButton.x=-t,this._eraserButton.drawMode=_["default"].TOOL.ERASER,this._eraserButton.signals.click.add(this._onDrawMode_Changed,this),this._rightBarSprite.addChild(this._eraserButton),_["default"].selectedGallery===_["default"].GALLERY_ID_DRAW_IT&&(this._drawItText=P3.createText(_["default"].drawItTextId,{size:"64px",fill:[16775347,16433417],stroke:4990471,strokeThickness:4,padding:20,wordWrapWidth:.65*P3.View.width},"truetype","draw_it"),this._drawItText.y=.5*-u["default"].STAGE_HEIGHT+15,this._drawItText.anchor=new PIXI.Point(.5,0),this.addChild(this._drawItText),this._drawItText.width>.8*u["default"].STAGE_MIN_WIDTH)){var i=.8*u["default"].STAGE_MIN_WIDTH/this._drawItText.width;this._drawItText.y+=(1-i)*this._drawItText.height*.5,this._drawItText.scale=new PIXI.Point(i,i)}this._highlightToolBtn(this._pencilButton),u["default"].game.undoManager.signals.onStackEmpty.add(this._onUndoStack_Empty,this),u["default"].game.undoManager.signals.onStackIncreased.add(this._onUndoStack_Increased,this),this._palettePanel.signals.onColourChanged.add(this._onPaletteSelection_Changed,this),this._palettePanel.signals.onStampChanged.add(this._onPaletteSelection_Changed,this)}},{key:"resize",value:function(){this._leftBarContainer.x=u["default"].getScreenPositionLeft()-this.x,this._rightBarContainer.x=u["default"].getScreenPositionRight()-this.x}},{key:"getPaletteBtnPosition",value:function(){return u["default"].findPositionInScene(this._paletteButton,u["default"].game.scene)}},{key:"getBrushBtnPosition",value:function(){return u["default"].findPositionInScene(this._brushButton,u["default"].game.scene)}},{key:"_highlightToolBtn",value:function(t){this._lastToolBtn&&(this._lastToolBtn.filters=[],TweenMax.killTweensOf(this._lastToolBtn.scale),this._lastToolBtn.animate=!0,TweenMax.to(this._lastToolBtn.scale,.25,{x:this._lastToolBtn.scale.x<0?-1:1,y:1,ease:Sine.easeOut,onComplete:function(t){t.interactive=!0},onCompleteParams:[this._lastToolBtn]})),t.animate=!1,t.interactive=!1,t.stopAnimations(),TweenMax.to(t.scale,.5,{x:1.1*(t.scale.x<0?-1:1),y:1.1,ease:Sine.easeInOut,yoyo:!0,repeat:-1}),this._lastToolBtn=t,this._lastToolBtn.filters=[new g["default"](9,16777215)]}},{key:"_onMenuButton_Click",value:function(){this.signals.onMenuClick.dispatch()}},{key:"_onUndoButton_Click",value:function(){u["default"].game.undoManager.undo(),u["default"].audio.playSound("sfx_tool_undo_step_back_00")}},{key:"_onDrawMode_Changed",value:function(t){this._highlightToolBtn(t),this._drawMode=t.drawMode,this.signals.onDrawModeChanged.dispatch(t.drawMode),t.drawMode==_["default"].TOOL.ERASER?this._paletteButton.setInteractive(!1):(this._paletteButton.setInteractive(!0),t.drawMode==_["default"].TOOL.BUCKET?this._paletteButton.setup(u["default"].game.canvas.fillLayer.paletteItem,t.drawMode):this._paletteButton.setup(u["default"].game.canvas.drawLayer.drawingTool.paletteItem,t.drawMode)),u["default"].game.scene.addTutorialEvent(_["default"].TUT_EVENT.TOOL_SELECTED),t.drawMode!=_["default"].TOOL.ERASER?u["default"].game.scene.addTutorialEvent(_["default"].TUT_EVENT.PALETTE_BUTTON_ENABLED):u["default"].game.scene.addTutorialEvent(_["default"].TUT_EVENT.PALETTE_BUTTON_DISABLED)}},{key:"_onUndoStack_Empty",value:function(){this._undoBtn.interactive=!1,this._undoBtn.alpha=.5}},{key:"_onUndoStack_Increased",value:function(){this._undoBtn.interactive=!0,this._undoBtn.alpha=1}},{key:"_onPaletteBtn_Click",value:function(){this.signals.onPaletteClick.dispatch(this._paletteButton.type)}},{key:"_onPaletteSelection_Changed",value:function(t,e){this._paletteButton.setup(t,this._paletteButton.type)}}]),e}(PIXI.Container);i["default"]=y},{"../Common":3,"../CommonGame":4,"../shaders/OutlineFilter":33,"../ui/overlays/PalettePanel":38,"./PaletteButton":19}],15:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){this.MIN_RADIUS=5,this.MAX_RADIUS=20,this._drawLayer=null,this._colour=null}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o);i["default"]=a,a.prototype.constructor=a,a.prototype.init=function(t){this._drawLayer=t,this._colour=s["default"].assets.getJSON("config").palettePanel.pages[0][0],s["default"].game.scene.palettePanel.signals.onColourChanged.add(this._onColour_Changed,this)},a.prototype._draw=function(t,e){this._drawLayer.context.beginPath(),this._drawLayer.context.globalAlpha=.25*Math.random()+.15,this._drawLayer.context.arc(e.x,e.y,s["default"].randomInt(this.MIN_RADIUS,this.MAX_RADIUS),!1,2*Math.PI,!1),this._drawLayer.context.fill(),this._drawLayer.onContext_Changed()},a.prototype.onDrawBegan=function(t){this._drawLayer.context.save(),this._drawLayer.context.lineJoin=this._drawLayer.context.lineCap="round",this._drawLayer.context.fillStyle=this._colour,this._draw(t,t),s["default"].audio.playSound("sfx_tool_inkpot_use_splat_00")},a.prototype.onDrawMoved=function(t,e){this._draw(t,e)},a.prototype.onDrawEnded=function(){this._drawLayer.context.restore()},a.prototype._onColour_Changed=function(t){0==t.indexOf("#")&&(this._colour=t)},Object.defineProperty(a.prototype,"paletteItem",{get:function(){return this._colour}})},{"../Common":3}],16:[function(t,e,i){"use strict";function n(){this.LINE_THICKNESS=20,this._drawLayer=null,this._textureId=null}var a=t("../Common");t("../CommonGame");e.exports=n,n.prototype.constructor=n,n.prototype.init=function(t){this._drawLayer=t},n.prototype._draw=function(t,e){this._drawLayer.context.beginPath(),this._drawLayer.context.moveTo(t.x,t.y),this._drawLayer.context.lineTo(e.x,e.y),this._drawLayer.context.stroke(),this._drawLayer.onContext_Changed()},n.prototype._createPattern=function(){var t=document.createElement("canvas"),e=t.getContext("2d"),i=a.assets.getTexture(this._textureId),n=i.frame;return t.width=t.height=n.width,e.drawImage(i.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height),e.createPattern(t,"repeat")},n.prototype.onDrawBegan=function(t){this._drawLayer.context.lineWidth=this.LINE_THICKNESS,this._drawLayer.context.lineJoin=this._drawLayer.context.lineCap="round",this._drawLayer.context.strokeStyle=this._createPattern(),this._draw(t,t)},n.prototype.onDrawMoved=function(t,e){this._draw(t,e)},n.prototype.onDrawEnded=function(){},Object.defineProperty(n.prototype,"textureId",{set:function(t){this._textureId=t}})},{"../Common":3,"../CommonGame":4}],17:[function(t,e,i){"use strict";function n(){this.LINE_THICKNESS=5,this._drawLayer=null,this._textureId=null}var a=t("../Common");t("../CommonGame");e.exports=n,n.prototype.constructor=n,n.prototype.init=function(t){this._drawLayer=t},n.prototype._draw=function(t,e){this._drawLayer.context.beginPath(),this._drawLayer.context.moveTo(t.x,t.y),this._drawLayer.context.lineTo(e.x,e.y),this._drawLayer.context.stroke(),this._drawLayer.onContext_Changed()},n.prototype._createPattern=function(){var t=document.createElement("canvas"),e=t.getContext("2d"),i=a.assets.getTexture(this._textureId),n=i.frame;return t.width=t.height=n.width,e.drawImage(i.baseTexture.source,n.x,n.y,n.width,n.height,0,0,n.width,n.height),e.createPattern(t,"repeat")},n.prototype.onDrawBegan=function(t){this._drawLayer.context.lineWidth=this.LINE_THICKNESS,this._drawLayer.context.lineJoin=this._drawLayer.context.lineCap="round",this._drawLayer.context.strokeStyle=this._createPattern(),this._draw(t,t)},n.prototype.onDrawMoved=function(t,e){this._draw(t,e)},n.prototype.onDrawEnded=function(){},Object.defineProperty(n.prototype,"textureId",{set:function(t){this._textureId=t}})},{"../Common":3,"../CommonGame":4}],18:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),s=t("../Common"),r=n(s),l=t("../CommonGame"),u=n(l),h=t("./HUD"),_=n(h),d=t("./UndoManager"),c=n(d),p=t("./Canvas"),f=n(p),g=function(){function t(){a(this,t),this._scene=null,this._decoration=null,this._hud=null,this._canvas=null,this._undoManager=null}return o(t,[{key:"init",value:function(){console.assert(null!=this._scene,"Initialization failed: this._scene is null."),this._undoManager=new c["default"],this._decoration=new PIXI.Container,this._initDecoration(),this._hud=new _["default"],this._hud.position=new PIXI.Point(.5*r["default"].STAGE_WIDTH,.5*r["default"].STAGE_HEIGHT),this._hud.init(),this._canvas=new f["default"],this._canvas.position=new PIXI.Point(.5*r["default"].STAGE_WIDTH,.5*r["default"].STAGE_HEIGHT),this._canvas.init(),this._scene.gameLayer.addChild(this._canvas),this._scene.gameLayer.addChild(this._decoration),this._scene.gameLayer.addChild(this._hud);var t=PIXI.Texture.fromImage("assets/images/outlines/"+(u["default"].selectedGallery==u["default"].GALLERY_ID_DRAW_IT?"draw_it/":"colour_it/")+u["default"].selectedImageId+".png"),e=new PIXI.Sprite(t);e.anchor.set(.5),this._canvas.addChild(e)}},{key:"update",value:function(){this._canvas.update()}},{key:"animateIn",value:function(){this._canvas.animateIn()}},{key:"resize",value:function(){this._hud.resize()}},{key:"_initDecoration",value:function(){var t=r["default"].assets.texture,e=new PIXI.Sprite(t("leaves")),i=.5*e.height;e.anchor.set(.5,.5),e.x=.5*r["default"].STAGE_WIDTH,e.y=-i;var n=new PIXI.Sprite(t("leaves"));n.anchor.set(.5,.5),n.scale.y=-1,n.x=.5*r["default"].STAGE_WIDTH,n.y=r["default"].STAGE_HEIGHT+i,this._decoration.addChild(e,n),TweenMax.to(e,2+.5*Math.random(),{y:0,ease:Elastic.easeOut.config(1,.3-.1*Math.random()),delay:.25*Math.random()}),TweenMax.to(n,2+.5*Math.random(),{y:r["default"].STAGE_HEIGHT,ease:Elastic.easeOut.config(1,.3-.1*Math.random()),delay:.25*Math.random()})}},{key:"scene",get:function(){return this._scene},set:function(t){this._scene=t}},{key:"hud",get:function(){return this._hud}},{key:"canvas",get:function(){return this._canvas}},{key:"undoManager",get:function(){return this._undoManager}}]),t}();i["default"]=g},{"../Common":3,"../CommonGame":4,"./Canvas":8,"./HUD":14,"./UndoManager":24}],19:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){PIXI.Container.call(this),this._button=null,this._selectionSprite=null,this._shineOverlay=null,this._type=null,this.signals={},this.signals.onClick=new signals.Signal}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o),r=t("../CommonGame"),l=n(r),u=t("../ui/overlays/PalettePanel");n(u);i["default"]=a,a.prototype=Object.create(PIXI.Container.prototype),a.prototype.constructor=a,a.prototype.init=function(){var t=new P3.ButtonStates(s["default"].assets.getTexture("icon_colour_palette_bg"),s["default"].assets.getTexture("icon_colour_palette_bg"),s["default"].assets.getTexture("icon_colour_palette_bg"));this._button=new P3.Button(t),this._button.anchor=new PIXI.Point(.5,.5),this._button.signals.click.add(this.signals.onClick.dispatch,this),this.addChild(this._button),this._selectionSprite=new PIXI.Sprite(s["default"].blankTexture),this._selectionSprite.x=-60,this._selectionSprite.y=21,this._selectionSprite.anchor=new PIXI.Point(.5,.5),this._button.addChild(this._selectionSprite),this._shineOverlay=new PIXI.Sprite(s["default"].assets.getTexture("btns_colour_overlay")),this._shineOverlay.anchor=new PIXI.Point(.5,.5),this._shineOverlay.blendMode=PIXI.BLEND_MODES.ADD,this._shineOverlay.alpha=.4,this._selectionSprite.addChild(this._shineOverlay)},a.prototype.setup=function(t,e){switch(this._type=e,this._selectionSprite.tint=16777215,this._type){case l["default"].TOOL.BRUSH:case l["default"].TOOL.PENCIL:case l["default"].TOOL.INK_POT:case l["default"].TOOL.SPRAY:case l["default"].TOOL.BUCKET:this._shineOverlay.visible=!0,this._button._currentNormalTexture=s["default"].assets.getTexture("icon_colour_palette_bg"),this._button._currentOverTexture=s["default"].assets.getTexture("icon_colour_palette_bg"),this._button._currentDownTexture=s["default"].assets.getTexture("icon_colour_palette_bg"),this._button._background.texture=this._button._currentNormalTexture,0==t.indexOf("#")?(this._selectionSprite.texture=s["default"].assets.getTexture("btns_colour_white"),this._selectionSprite.tint=parseInt("0x"+t.substring(1))):this._selectionSprite.texture=s["default"].assets.getTexture(l["default"].TEXTURE_BUTTON_BASE_ID+t.substring(t.length-2)),this._selectionSprite.scale.x=-.8,this._selectionSprite.scale.y=.8;break;case l["default"].TOOL.STAMP:this._shineOverlay.visible=!1,this._button._currentNormalTexture=s["default"].assets.getTexture("icon_stamp_palette_bg"),this._button._currentOverTexture=s["default"].assets.getTexture("icon_stamp_palette_bg"),this._button._currentDownTexture=s["default"].assets.getTexture("icon_stamp_palette_bg"),this._button._background.texture=this._button._currentNormalTexture,this._selectionSprite.texture=s["default"].assets.getTexture(t),this._selectionSprite.scale.x=-1,this._selectionSprite.scale.y=.8}},a.prototype.setInteractive=function(t){this._button.interactive=t,this._button.alpha=t?1:.5,this._selectionSprite.alpha=this._button.alpha},Object.defineProperty(a.prototype,"type",{get:function(){return this._type}})},{"../Common":3,"../CommonGame":4,"../ui/overlays/PalettePanel":38}],20:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){this._drawLayer=null,this._magicPencil=null,this._colourPencil=null,this._paletteItem=null,this._curPencil=null,this._audio=null}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o),r=t("../ui/overlays/PalettePanel"),l=(n(r),t("./MagicPencil")),u=n(l),h=t("./ColourPencil"),_=n(h);i["default"]=a,a.prototype.constructor=a,a.prototype.init=function(t){this._drawLayer=t,this._magicPencil=new u["default"],this._magicPencil.init(t),this._colourPencil=new _["default"],this._colourPencil.init(t),this._curPencil=this._colourPencil,this._curPencil.colour=s["default"].assets.getJSON("config").palettePanel.pages[0][0],this._paletteItem=this._curPencil.colour,s["default"].game.scene.palettePanel.signals.onColourChanged.add(this._onColour_Changed,this)},a.prototype._draw=function(t,e){s["default"].game.canvas.drawLayer._dynOutlineContext.beginPath(),s["default"].game.canvas.drawLayer._dynOutlineContext.strokeStyle="black",s["default"].game.canvas.drawLayer._dynOutlineContext.lineWidth=this._curPencil.LINE_THICKNESS,s["default"].game.canvas.drawLayer._dynOutlineContext.lineJoin="round",s["default"].game.canvas.drawLayer._dynOutlineContext.moveTo(t.x,t.y),s["default"].game.canvas.drawLayer._dynOutlineContext.lineTo(e.x,e.y),s["default"].game.canvas.drawLayer._dynOutlineContext.closePath(),s["default"].game.canvas.drawLayer._dynOutlineContext.stroke()},a.prototype._stopAudio=function(){this._audio.howl.stop(this._audio.id),this._audio=null},a.prototype.onDrawBegan=function(t){this._curPencil.onDrawBegan(t),this._draw(t,new PIXI.Point(t.x+.1,t.y+.1))},a.prototype.onDrawMoved=function(t,e){null==this._audio&&(this._audio=s["default"].audio.playSound("sfx_tool_pencil_use_loop_00",{loop:!0})),TweenMax.killDelayedCallsTo(this._stopAudio),TweenMax.delayedCall(.25,this._stopAudio,null,this),this._curPencil.onDrawMoved(t,e),this._draw(t,e)},a.prototype.onDrawEnded=function(){TweenMax.killDelayedCallsTo(this._stopAudio),null!=this._audio&&this._stopAudio(),s["default"].game.canvas.drawLayer.dynOutlineData=s["default"].game.canvas.drawLayer._dynOutlineContext.getImageData(0,0,s["default"].game.canvas.WIDTH,s["default"].game.canvas.HEIGHT)},a.prototype._onColour_Changed=function(t){0==t.indexOf("#")?(this._curPencil=this._colourPencil,this._colourPencil.colour=t):(this._curPencil=this._magicPencil,this._magicPencil.textureId=t),this._paletteItem=t},Object.defineProperty(a.prototype,"paletteItem",{get:function(){return this._paletteItem}})},{"../Common":3,"../ui/overlays/PalettePanel":38,"./ColourPencil":10,"./MagicPencil":17}],21:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){this.DENSITY=40,this.PERIOD=.05,this.RADIUS=15,this._drawLayer=null,this._drawPosition=null,this._colour=null,this._audio=null}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o);i["default"]=a,a.prototype.constructor=a,a.prototype.init=function(t){this._drawLayer=t,this._colour=s["default"].assets.getJSON("config").palettePanel.pages[0][0],s["default"].game.scene.palettePanel.signals.onColourChanged.add(this._onColour_Changed,this)},a.prototype._stopAudio=function(){this._audio.howl.stop(this._audio.id),this._audio=null},a.prototype._draw=function(){if(null!=this._drawPosition){for(var t=this.DENSITY;t--;)this._drawLayer.context.save(),this._drawColour(),this._drawLayer.context.restore();TweenMax.delayedCall(this.PERIOD,this._draw,null,this),this._drawLayer.onContext_Changed()}},a.prototype._drawColour=function(){var t=s["default"].randomFloat(0,2*Math.PI),e=s["default"].randomFloat(0,this.RADIUS);this._drawLayer.context.fillStyle=this._colour,this._drawLayer.context.globalAlpha=Math.random(),this._drawLayer.context.fillRect(this._drawPosition.x+e*Math.cos(t),this._drawPosition.y+e*Math.sin(t),s["default"].randomFloat(1,2),s["default"].randomFloat(1,2))},a.prototype.onDrawBegan=function(t){this._drawPosition=new PIXI.Point(t.x,t.y),this._drawLayer.context.lineJoin=this._drawLayer.context.lineCap="round",this._draw(),this._audio=s["default"].audio.playSound("sfx_tool_spraycan_use_loop_00",{loop:!0})},a.prototype.onDrawMoved=function(t,e){this._drawPosition.x=e.x,this._drawPosition.y=e.y},a.prototype.onDrawEnded=function(){TweenMax.killTweensOf(this),this._drawPosition=null,this._stopAudio()},a.prototype._onColour_Changed=function(t){0==t.indexOf("#")&&(this._colour=t)},Object.defineProperty(a.prototype,"paletteItem",{get:function(){return this._colour}})},{"../Common":3}],22:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){this._drawLayer=null,this._paletteItem=null}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o),r=t("../CommonGame");n(r);i["default"]=a,a.prototype.constructor=a,a.prototype.init=function(t){this._drawLayer=t,this._paletteItem=s["default"].assets.getJSON("config").palettePanel.pages[s["default"].assets.getJSON("config").palettePanel.tools.stamp[0]][0],s["default"].game.scene.palettePanel.signals.onStampChanged.add(this._onStamp_Changed,this)},a.prototype.onDrawBegan=function(t){Math.random();this._drawLayer.context.save(),this._drawLayer.context.translate(t.x,t.y);var e=s["default"].assets.getTexture(this._paletteItem),i=e.frame;this._drawLayer.context.drawImage(e.baseTexture.source,i.x*s["default"].main.assetRes,i.y*s["default"].main.assetRes,i.width*s["default"].main.assetRes,i.height*s["default"].main.assetRes,.5*-i.width,.5*-i.height,i.width,i.height),this._drawLayer.context.restore(),this._drawLayer.onContext_Changed(),s["default"].audio.playSound("sfx_tool_stamp_use_00")},a.prototype.onDrawMoved=function(t,e){},a.prototype.onDrawEnded=function(){},a.prototype._onStamp_Changed=function(t){this._paletteItem=t},Object.defineProperty(a.prototype,"paletteItem",{get:function(){return this._paletteItem}})},{"../Common":3,"../CommonGame":4}],23:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){PIXI.Container.call(this),this.STATE={DRAW:0,TOOL:1,PALETTE:2,IDLE:3},this.TUT_STEP_DELAY=3,this._isPaused=!1,this._tutorialStepTimer=0,this._tutorialHand=null,this._state=this.STATE.IDLE,this._arrEvent=[],this._arrTutorialStep=[{state:this.STATE.DRAW,isValid:!1,isDone:!s["default"].savedData.isDrawTutorial},{state:this.STATE.TOOL,isValid:!0,isDone:!s["default"].savedData.isToolTutorial},{state:this.STATE.PALETTE,isValid:!1,isDone:!s["default"].savedData.isPaletteTutorial}],this.signals={},this.signals.onCompleted=new signals.Signal}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o),r=t("../CommonGame"),l=n(r),u=t("../ui/overlays/PalettePanel"),h=(n(u),t("./PaletteButton"));n(h);i["default"]=a,a.prototype=Object.create(PIXI.Container.prototype),a.prototype.constructor=a,a.prototype.init=function(){this._tutorialHand=new PIXI.spine.Spine(s["default"].assets.spineData("tutorial_hand")),this._tutorialHand.skeleton.setToSetupPose(),this._tutorialHand.skeleton.setSkin(null),this._tutorialHand.skeleton.setSkinByName("default"),this._tutorialHand.autoUpdate=!1,this._tutorialHand.scale=new PIXI.Point(.7,.7),this._tutorialHand.alpha=0,this.addChild(this._tutorialHand),this._tutorialHand.state.setAnimationByName(0,"still_"+(P3.Device.isMobile?"mobile":"desktop"),!0),this._tutorialHand.update(deltaTime)},a.prototype.end=function(){this.removeChild(this._tutorialHand),this._tutorialHand.destroy(),this._tutorialHand=null},a.prototype.update=function(){if(null!=this._tutorialHand&&(this._tutorialHand.update(deltaTime),this._processEvents(),!this._isPaused&&(this._tutorialStepTimer+=deltaTime,this._tutorialStepTimer>=this.TUT_STEP_DELAY&&this._state==this.STATE.IDLE))){var t=!0,e=!1,i=void 0;try{for(var n,a=this._arrTutorialStep[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var o=n.value;if(o.isValid&&!o.isDone)switch(this._state=o.state,this._state){case this.STATE.DRAW:this._tutorialHand.state.setAnimationByName(0,"drag_"+(P3.Device.isMobile?"mobile":"desktop"),!0),this._tutorialHand.position=new PIXI.Point(.5*s["default"].STAGE_WIDTH,.5*s["default"].STAGE_HEIGHT),this._showHand();break;case this.STATE.TOOL:this._tutorialHand.state.setAnimationByName(0,"tap_"+(P3.Device.isMobile?"mobile":"desktop"),!0),this._tutorialHand.position=s["default"].game.hud.getBrushBtnPosition(),this._showHand();break;case this.STATE.PALETTE:this._tutorialHand.state.setAnimationByName(0,"tap_"+(P3.Device.isMobile?"mobile":"desktop"),!0),this._tutorialHand.position=s["default"].game.hud.getPaletteBtnPosition(),this._showHand()}if(!o.isDone)break}}catch(r){e=!0,i=r}finally{try{!t&&a["return"]&&a["return"]()}finally{if(e)throw i}}this._tutorialStepTimer=0}},a.prototype.addEvent=function(t){this._arrEvent.push(t)},a.prototype.resize=function(){null!=this._tutorialHand&&(this._state==this.STATE.DRAW?this._tutorialHand.position=new PIXI.Point(.5*s["default"].STAGE_WIDTH,.5*s["default"].STAGE_HEIGHT):this._state==this.STATE.TOOL?this._tutorialHand.position=s["default"].game.hud.getBrushBtnPosition():this._state==this.STATE.PALETTE&&(this._tutorialHand.position=s["default"].game.hud.getPaletteBtnPosition()))},a.prototype._processEvents=function(){var t=!0,e=!1,i=void 0;try{for(var n,a=this._arrEvent[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var o=n.value;switch(o){case l["default"].TUT_EVENT.CANVAS_VISIBLE:this._arrTutorialStep[this.STATE.DRAW].isValid=!0;break;case l["default"].TUT_EVENT.PALETTE_SELECTED:this._state==this.STATE.DRAW||this._state==this.STATE.TOOL?this._hideHand():this._state==this.STATE.PALETTE&&(this._hideHand(this._checkTutorialEnd),this._state=this.STATE.IDLE),s["default"].savedData.isPaletteTutorial&&(this._arrTutorialStep[this.STATE.PALETTE].isDone=!0,s["default"].savedData.isPaletteTutorial=!1,s["default"].savedData.save()),this._isPaused=!0,this._tutorialStepTimer=0;break;case l["default"].TUT_EVENT.MENU_PANEL_SHOWN:this._state!=this.STATE.IDLE&&this._hideHand(),this._isPaused=!0,this._tutorialStepTimer=0;break;case l["default"].TUT_EVENT.MENU_PANEL_HIDDEN:case l["default"].TUT_EVENT.PALETTE_PANEL_HIDDEN:this._state!=this.STATE.IDLE&&this._showHand(),this._isPaused=!1,this._tutorialStepTimer=0;break;case l["default"].TUT_EVENT.PALETTE_BUTTON_ENABLED:this._arrTutorialStep[this.STATE.PALETTE].isValid=!0,this._state==this.STATE.PALETTE&&this._showHand();break;case l["default"].TUT_EVENT.PALETTE_BUTTON_DISABLED:this._arrTutorialStep[this.STATE.PALETTE].isValid=!1,this._state==this.STATE.PALETTE&&this._hideHand();break;case l["default"].TUT_EVENT.TOOL_SELECTED:this._state==this.STATE.TOOL&&(this._hideHand(this._checkTutorialEnd),this._state=this.STATE.IDLE),s["default"].savedData.isToolTutorial&&(this._arrTutorialStep[this.STATE.TOOL].isDone=!0,s["default"].savedData.isToolTutorial=!1,s["default"].savedData.save()),this._tutorialStepTimer=0;break;case l["default"].TUT_EVENT.CANVAS_DRAWN:this._state==this.STATE.DRAW&&(this._hideHand(this._checkTutorialEnd),this._state=this.STATE.IDLE),s["default"].savedData.isDrawTutorial&&(this._arrTutorialStep[this.STATE.DRAW].isDone=!0,
s["default"].savedData.isDrawTutorial=!1,s["default"].savedData.save()),this._tutorialStepTimer=0}}}catch(r){e=!0,i=r}finally{try{!t&&a["return"]&&a["return"]()}finally{if(e)throw i}}this._arrEvent=[]},a.prototype._showHand=function(){TweenMax.to(this._tutorialHand,.25,{alpha:1})},a.prototype._hideHand=function(t){var e=TweenMax.to(this._tutorialHand,.25,{alpha:0});null!=t&&e.eventCallback("onComplete",t,null,this)},a.prototype._checkTutorialEnd=function(){s["default"].savedData.isDrawTutorial||s["default"].savedData.isToolTutorial||s["default"].savedData.isPaletteTutorial||this.signals.onCompleted.dispatch()}},{"../Common":3,"../CommonGame":4,"../ui/overlays/PalettePanel":38,"./PaletteButton":19}],24:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){this.MAX_STACK_SIZE=3,this._arrLayerState=[],this.signals={},this.signals.onStackEmpty=new signals.Signal,this.signals.onStackIncreased=new signals.Signal}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o),r=t("../CommonGame");n(r);i["default"]=a,a.prototype.constructor=a,a.prototype.save=function(){var t=s["default"].game.canvas.drawLayer.context.getImageData(0,0,s["default"].game.canvas.WIDTH,s["default"].game.canvas.HEIGHT),e=s["default"].game.canvas.drawLayer.dynOutlineContext.getImageData(0,0,s["default"].game.canvas.WIDTH,s["default"].game.canvas.HEIGHT),i=s["default"].game.canvas.fillLayer.colourContext.getImageData(0,0,s["default"].game.canvas.WIDTH,s["default"].game.canvas.HEIGHT),n=s["default"].game.canvas.fillLayer.colourCodeContext.getImageData(0,0,s["default"].game.canvas.WIDTH,s["default"].game.canvas.HEIGHT);this._arrLayerState.length==this.MAX_STACK_SIZE&&this._arrLayerState.splice(0,1),this._arrLayerState.push({drawlayerData:t,drawDynOutlineData:e,fillLayerData:i,fillColourCodeData:n}),this.signals.onStackIncreased.dispatch()},a.prototype.undo=function(){if(0!=this._arrLayerState.length){var t=this._arrLayerState.splice(this._arrLayerState.length-1,1)[0];s["default"].game.canvas.fillLayer.setLayerData(t.fillLayerData,t.fillColourCodeData),s["default"].game.canvas.drawLayer.setLayerData(t.drawlayerData,t.drawDynOutlineData),0==this._arrLayerState.length&&this.signals.onStackEmpty.dispatch()}},a.prototype.clear=function(){this._arrLayerState=[],this.signals.onStackEmpty.dispatch()}},{"../Common":3,"../CommonGame":4}],25:[function(t,e,i){(function(e){"use strict";function i(t){return t&&t.__esModule?t:{"default":t}}var n=t("./Main"),a=i(n);e.Main=a["default"]}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./Main":5}],26:[function(t,e,i){(function(n){"use strict";var a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t};!function(t){if("object"===("undefined"==typeof i?"undefined":a(i))&&"undefined"!=typeof e)e.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var o;o="undefined"!=typeof window?window:"undefined"!=typeof n?n:"undefined"!=typeof self?self:this,o.MultiStyleText=t()}}(function(){var e;return function i(e,n,a){function o(r,l){if(!n[r]){if(!e[r]){var u="function"==typeof t&&t;if(!l&&u)return u(r,!0);if(s)return s(r,!0);var h=new Error("Cannot find module '"+r+"'");throw h.code="MODULE_NOT_FOUND",h}var _=n[r]={exports:{}};e[r][0].call(_.exports,function(t){var i=e[r][1][t];return o(i?i:t)},_,_.exports,i,e,n,a)}return n[r].exports}for(var s="function"==typeof t&&t,r=0;r<a.length;r++)o(a[r]);return o}({1:[function(t,e,i){e.exports=t("./pixi-multistyle-text")["default"]},{"./pixi-multistyle-text":2}],2:[function(t,i,n){var o=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])};return function(e,i){function n(){this.constructor=e}t(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(o){if("object"===("undefined"==typeof i?"undefined":a(i))&&"object"===a(i.exports)){var s=o(t,n);void 0!==s&&(i.exports=s)}else"function"==typeof e&&e.amd&&e(["require","exports"],o)}(function(t,e){Object.defineProperty(e,"__esModule",{value:!0});var i=function(t){function e(e,i){var n=t.call(this,e)||this;return n.styles=i,n}return o(e,t),Object.defineProperty(e.prototype,"styles",{set:function(t){this.textStyles={},this.textStyles["default"]=this.assign({},e.DEFAULT_TAG_STYLE);for(var i in t)"default"===i?this.assign(this.textStyles["default"],t[i]):this.textStyles[i]=this.assign({},t[i]);this._style=new PIXI.TextStyle(this.textStyles["default"]),this.dirty=!0},enumerable:!0,configurable:!0}),e.prototype.setTagStyle=function(t,e){t in this.textStyles?this.assign(this.textStyles[t],e):this.textStyles[t]=this.assign({},e),this._style=new PIXI.TextStyle(this.textStyles["default"]),this.dirty=!0},e.prototype.deleteTagStyle=function(t){"default"===t?this.textStyles["default"]=this.assign({},e.DEFAULT_TAG_STYLE):delete this.textStyles[t],this._style=new PIXI.TextStyle(this.textStyles["default"]),this.dirty=!0},e.prototype._getTextDataPerLine=function(t){for(var e=[],i=Object.keys(this.textStyles).join("|"),n=new RegExp("</?("+i+")>","g"),a=[this.assign({},this.textStyles["default"])],o=["default"],s=0;s<t.length;s++){for(var r=[],l=[],u=void 0;u=n.exec(t[s]);)l.push(u);if(0===l.length)r.push(this.createTextData(t[s],a[a.length-1],o[o.length-1]));else{for(var h=0,_=0;_<l.length;_++)l[_].index>h&&r.push(this.createTextData(t[s].substring(h,l[_].index),a[a.length-1],o[o.length-1])),"/"===l[_][0][1]?a.length>1&&(a.pop(),o.pop()):(a.push(this.assign({},a[a.length-1],this.textStyles[l[_][1]])),o.push(l[_][1])),h=l[_].index+l[_][0].length;h<t[s].length&&r.push(this.createTextData(t[s].substring(h),a[a.length-1],o[o.length-1]))}e.push(r)}return e},e.prototype.getFontString=function(t){return new PIXI.TextStyle(t).toFontString()},e.prototype.createTextData=function(t,e,i){return{text:t,style:e,width:0,height:0,fontProperties:void 0,tagName:i}},e.prototype.getDropShadowPadding=function(){var t=this,e=0,i=0;return Object.keys(this.textStyles).forEach(function(n){var a=t.textStyles[n],o=a.dropShadowDistance,s=a.dropShadowBlur;e=Math.max(e,o||0),i=Math.max(i,s||0)}),e+i},e.prototype.updateText=function(){var t=this;if(this.dirty){this.texture.baseTexture.resolution=this.resolution;var i=this.textStyles,n=this.text;this._style.wordWrap&&(n=this.wordWrap(this.text));for(var a=n.split(/(?:\r\n|\r|\n)/),o=this._getTextDataPerLine(a),s=[],r=[],l=[],u=0,h=0;h<a.length;h++){for(var _=0,d=0,c=0,p=0;p<o[h].length;p++){var f=o[h][p].style;this.context.font=this.getFontString(f),o[h][p].width=this.context.measureText(o[h][p].text).width,0===o[h][p].text.length&&(o[h][p].width+=(o[h][p].text.length-1)*f.letterSpacing,p>0&&(_+=f.letterSpacing/2),p<o[h].length-1&&(_+=f.letterSpacing/2)),_+=o[h][p].width,o[h][p].fontProperties=PIXI.TextMetrics.measureFont(this.context.font),o[h][p].height=o[h][p].fontProperties.fontSize+o[h][p].style.strokeThickness,"number"==typeof f.valign?(d=Math.min(d,f.valign-o[h][p].fontProperties.descent),c=Math.max(c,f.valign+o[h][p].fontProperties.ascent)):(d=Math.min(d,-o[h][p].fontProperties.descent),c=Math.max(c,o[h][p].fontProperties.ascent))}var g,y=Object.keys(i).map(function(t){return i[t]});y.reduce(function(t,e){return g=e.strokeThickness,Math.max(t,e.strokeThickness||0)},0);_+=8*g,s[h]=_,r[h]=d,l[h]=c,u=Math.max(u,_)}var m=Object.keys(i).map(function(t){return i[t]}),w=m.reduce(function(t,e){return Math.max(t,e.strokeThickness||0)},0),T=this.getDropShadowPadding(),x=l.reduce(function(t,e){return t+e},0)-r.reduce(function(t,e){return t+e},0),I=u+w+2*T,v=x+2*T;this.canvas.width=(I+this.context.lineWidth)*this.resolution,this.canvas.height=v*this.resolution,this.context.scale(this.resolution,this.resolution),this.context.textBaseline="alphabetic",this.context.lineJoin="round";for(var P=T,S=[],h=0;h<o.length;h++){var C=o[h],b=void 0;switch(this._style.align){case"left":b=T;break;case"center":b=T+(u-s[h])/2;break;case"right":b=T+u-s[h]}for(var p=0;p<C.length;p++){var E=C[p],B=E.style,O=E.text,L=E.fontProperties,A=E.width,k=(E.height,E.tagName);b+=w/2;var D=w/2+P+L.ascent;switch(B.valign){case"top":break;case"baseline":D+=l[h]-L.ascent;break;case"middle":D+=(l[h]-r[h]-L.ascent-L.descent)/2;break;case"bottom":D+=l[h]-r[h]-L.ascent-L.descent;break;default:D+=l[h]-L.ascent-B.valign}if(0===B.letterSpacing)S.push({text:O,style:B,x:b,y:D,width:A,ascent:L.ascent,descent:L.descent,tagName:k}),b+=C[p].width;else{this.context.font=this.getFontString(C[p].style);for(var M=0;M<O.length;M++)(M>0||p>0)&&(b+=B.letterSpacing/2),S.push({text:O.charAt(M),style:B,x:b,y:D,width:A,ascent:L.ascent,descent:L.descent,tagName:k}),b+=this.context.measureText(O.charAt(M)).width,(M<O.length-1||p<C.length-1)&&(b+=B.letterSpacing/2)}b-=w/2}P+=l[h]-r[h]}this.context.save(),S.forEach(function(e){var i=e.style,n=e.text,a=e.x,o=e.y;if(i.dropShadow){t.context.font=t.getFontString(i);var s=i.dropShadowColor;"number"==typeof s&&(s=PIXI.utils.hex2string(s)),t.context.shadowColor=s,t.context.shadowBlur=i.dropShadowBlur,t.context.shadowOffsetX=Math.cos(i.dropShadowAngle)*i.dropShadowDistance*t.resolution,t.context.shadowOffsetY=Math.sin(i.dropShadowAngle)*i.dropShadowDistance*t.resolution,t.context.fillText(n,a,o)}}),this.context.restore(),S.forEach(function(i){var n=i.style,a=i.text,o=i.x,s=i.y,r=i.width,l=i.ascent,u=i.descent,h=i.tagName;t.context.font=t.getFontString(n);var _=n.stroke;"number"==typeof _&&(_=PIXI.utils.hex2string(_)),t.context.strokeStyle=_,t.context.lineWidth=n.strokeThickness;var d=n.fill;if("number"==typeof d)d=PIXI.utils.hex2string(d);else if(Array.isArray(d))for(var c=0;c<d.length;c++){var p=d[c];"number"==typeof p&&(d[c]=PIXI.utils.hex2string(p))}t.context.fillStyle=t._generateFillStyle(new PIXI.TextStyle(n),[a]),n.stroke&&n.strokeThickness&&t.context.strokeText(a,o,s),n.fill&&t.context.fillText(a,o,s);var f=void 0===n.debug?e.debugOptions.spans.enabled:n.debug;f&&(t.context.lineWidth=1,e.debugOptions.spans.bounding&&(t.context.fillStyle=e.debugOptions.spans.bounding,t.context.strokeStyle=e.debugOptions.spans.bounding,t.context.beginPath(),t.context.rect(o,s-l,r,l+u),t.context.fill(),t.context.stroke(),t.context.stroke()),e.debugOptions.spans.baseline&&(t.context.strokeStyle=e.debugOptions.spans.baseline,t.context.beginPath(),t.context.moveTo(o,s),t.context.lineTo(o+r,s),t.context.closePath(),t.context.stroke()),e.debugOptions.spans.top&&(t.context.strokeStyle=e.debugOptions.spans.top,t.context.beginPath(),t.context.moveTo(o,s-l),t.context.lineTo(o+r,s-l),t.context.closePath(),t.context.stroke()),e.debugOptions.spans.bottom&&(t.context.strokeStyle=e.debugOptions.spans.bottom,t.context.beginPath(),t.context.moveTo(o,s+u),t.context.lineTo(o+r,s+u),t.context.closePath(),t.context.stroke()),e.debugOptions.spans.text&&(t.context.fillStyle="#ffffff",t.context.strokeStyle="#000000",t.context.lineWidth=2,t.context.font="8px monospace",t.context.strokeText(h,o,s-l+8),t.context.fillText(h,o,s-l+8),t.context.strokeText(r.toFixed(2)+"x"+(l+u).toFixed(2),o,s-l+16),t.context.fillText(r.toFixed(2)+"x"+(l+u).toFixed(2),o,s-l+16)))}),e.debugOptions.objects.enabled&&(e.debugOptions.objects.bounding&&(this.context.fillStyle=e.debugOptions.objects.bounding,this.context.beginPath(),this.context.rect(0,0,I,v),this.context.fill()),e.debugOptions.objects.text&&(this.context.fillStyle="#ffffff",this.context.strokeStyle="#000000",this.context.lineWidth=2,this.context.font="8px monospace",this.context.strokeText(I.toFixed(2)+"x"+v.toFixed(2),0,8,I),this.context.fillText(I.toFixed(2)+"x"+v.toFixed(2),0,8,I))),this.updateTexture()}},e.prototype.wordWrap=function(t){var e="",i=Object.keys(this.textStyles).join("|"),n=new RegExp("(</?("+i+")>)","g"),a=t.split("\n"),o=this._style.wordWrapWidth,s=[this.assign({},this.textStyles["default"])];this.context.font=this.getFontString(this.textStyles["default"]);for(var r=0;r<a.length;r++){for(var l=o,u=a[r].split(" "),h=0;h<u.length;h++)for(var _=u[h].split(n),d=0;d<_.length;d++)if(n.test(_[d]))e+=_[d],"/"===_[d][1]?(d++,s.pop()):(d++,s.push(this.assign({},s[s.length-1],this.textStyles[_[d]]))),this.context.font=this.getFontString(s[s.length-1]);else{var c=this.context.measureText(_[d]).width;if(this._style.breakWords&&c>l){var p=_[d].split("");h>0&&0===d&&(e+=" ",l-=this.context.measureText(" ").width);for(var f=0;f<p.length;f++){var g=this.context.measureText(p[f]).width;g>l?(e+="\n"+p[f],l=o-g):(h>0&&0===d&&0===f&&(e+=" "),e+=p[f],l-=g)}}else if(this._style.breakWords)e+=_[d],l-=c;else{var y=c+(0===d?this.context.measureText(" ").width:0);0===h||y>l?(h>0&&(e+="\n"),e+=_[d],l=o-c):(l-=y,0===d&&(e+=" "),e+=_[d])}}r<a.length-1&&(e+="\n")}return e},e.prototype.updateTexture=function(){var t=this._texture,e=this.getDropShadowPadding();t.baseTexture.hasLoaded=!0,t.baseTexture.resolution=this.resolution,t.baseTexture.realWidth=this.canvas.width,t.baseTexture.realHeight=this.canvas.height,t.baseTexture.width=this.canvas.width/this.resolution,t.baseTexture.height=this.canvas.height/this.resolution,t.trim.width=t.frame.width=this.canvas.width/this.resolution,t.trim.height=t.frame.height=this.canvas.height/this.resolution,t.trim.x=-this._style.padding-e,t.trim.y=-this._style.padding-e,t.orig.width=t.frame.width-2*(this._style.padding+e),t.orig.height=t.frame.height-2*(this._style.padding+e),this._onTextureUpdate(),t.baseTexture.emit("update",t.baseTexture),this.dirty=!1},e.prototype.assign=function(t){for(var e=[],i=1;i<arguments.length;i++)e[i-1]=arguments[i];for(var n=0,a=e;n<a.length;n++){var o=a[n];for(var s in o)t[s]=o[s]}return t},e}(PIXI.Text);i.DEFAULT_TAG_STYLE={align:"left",breakWords:!1,dropShadow:!1,dropShadowAngle:Math.PI/6,dropShadowBlur:0,dropShadowColor:"#000000",dropShadowDistance:5,fill:"black",fillGradientType:PIXI.TEXT_GRADIENT.LINEAR_VERTICAL,fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",letterSpacing:0,lineHeight:0,lineJoin:"miter",miterLimit:10,padding:0,stroke:"black",strokeThickness:0,textBaseline:"alphabetic",valign:"baseline",wordWrap:!1,wordWrapWidth:100},i.debugOptions={spans:{enabled:!1,baseline:"#44BB44",top:"#BB4444",bottom:"#4444BB",bounding:"rgba(255, 255, 255, 0.1)",text:!0},objects:{enabled:!1,bounding:"rgba(255, 255, 255, 0.05)",text:!0}},e["default"]=i})},{}]},{},[1])(1)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./pixi-multistyle-text":26}],27:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function g(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:g(a,e,i)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(i)},u=t("../Common"),h=n(u),_=t("../CommonGame"),d=n(_),c=t("./SimpleScene"),p=n(c),f=function(t){function e(){a(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._colourItBtn=null,t._drawItBtn=null,t._colourItText=null,t._drawItText=null,t._titleSprite=null,t._titleText=null,t._colourItSprite=null,t._drawItSprite=null,t}return s(e,t),r(e,[{key:"init",value:function(){this._bgSprite=new PIXI.Sprite(h["default"].assets.getTexture("bg")),l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this);var t=new P3.ButtonStates(h["default"].assets.getTexture("game_colour"),h["default"].assets.getTexture("game_colour"),h["default"].assets.getTexture("game_colour"));this._colourItSprite=new P3.Button(t),this._colourItSprite.signals.click.addOnce(this._onColourGalleryButton_Click,this),this._colourItSprite.anchor=new PIXI.Point(.5,.5),this._colourItSprite.position=new PIXI.Point(.5*h["default"].STAGE_WIDTH-255,.5*h["default"].STAGE_HEIGHT),this.addChild(this._colourItSprite);var i={size:"75px",fill:"#3992ff",stroke:"#2c1812",wordWrapWidth:400};this._colourItText=P3.createMultiText("COLOUR_IT",i),this._colourItText.anchor=new PIXI.Point(.5,.5),this._colourItText.y=.5*-this._colourItSprite.height+15,this._colourItSprite.addChild(this._colourItText),this._colourItBtn=createButton("play_large","primary_large"),this._colourItBtn.anchor=new PIXI.Point(.5,.5),this._colourItBtn.y=this._colourItSprite.y+.5*this._colourItSprite.height,this._colourItBtn.x=this._colourItSprite.x,this._colourItBtn.overSoundName="sfx_ui_rollover_00",this._colourItBtn.downSoundName="sfx_btn_play_start_doorbell_00",this._colourItBtn.signals.click.addOnce(this._onColourGalleryButton_Click,this),this.addChild(this._colourItBtn),t=new P3.ButtonStates(h["default"].assets.getTexture("game_draw"),h["default"].assets.getTexture("game_draw"),h["default"].assets.getTexture("game_draw")),this._drawItSprite=new P3.Button(t),this._drawItSprite.signals.click.addOnce(this._onDrawGalleryButton_Click,this),this._drawItSprite.anchor=new PIXI.Point(.5,.5),this._drawItSprite.position=new PIXI.Point(.5*h["default"].STAGE_WIDTH+255,.5*h["default"].STAGE_HEIGHT),this.addChild(this._drawItSprite),this._drawItText=P3.createText("DRAW_IT",{size:"75px",fill:"white",stroke:"#2c1812",stokeThickness:6,wordWrap:!0,wordWrapWidth:300},"truetype"),this._drawItText.anchor=new PIXI.Point(.5,.5),this._drawItText.y=.5*-this._drawItSprite.height+15,this._drawItSprite.addChild(this._drawItText),this._drawItBtn=createButton("play_large","primary_large"),this._drawItBtn.anchor=new PIXI.Point(.5,.5),this._drawItBtn.position.y=this._drawItSprite.y+.5*this._drawItSprite.height,this._drawItBtn.position.x=this._drawItSprite.x,this._drawItBtn.overSoundName="sfx_ui_rollover_00",this._drawItBtn.downSoundName="sfx_btn_play_start_doorbell_00",this._drawItBtn.signals.click.addOnce(this._onDrawGalleryButton_Click,this),this.addChild(this._drawItBtn),l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createSharedControls",this).call(this,this),this._uiTopBarSharedControls.muteBtn.visible=!0,this._uiTopBarSharedControls.backBtn.visible=!0,this._uiTopBarSharedControls.signals.onBackBtn_Click.addOnce(function(){this.signals.previous.dispatch(this)},this)}},{key:"destroy",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this,{children:!0}),TweenMax.killAll()}},{key:"animateIn",value:function(){this._drawItSprite.x+=100,this._drawItSprite.alpha=0,TweenMax.to(this._drawItSprite,.25,{alpha:1,x:this._drawItSprite.x-100,ease:Sine.easeOut}),this._colourItSprite.x-=100,this._colourItSprite.alpha=0,TweenMax.to(this._colourItSprite,.25,{alpha:1,x:this._colourItSprite.x+100,ease:Sine.easeOut}),this._drawItBtn.alpha=0,this._drawItBtn.scale=new PIXI.Point,TweenMax.to(this._drawItBtn,.25,{alpha:1,ease:Sine.easeOut,delay:.2}),TweenMax.to(this._drawItBtn.scale,.5,{x:1,y:1,ease:Elastic.easeOut,delay:.2}),this._colourItBtn.alpha=0,this._colourItBtn.scale=new PIXI.Point,TweenMax.to(this._colourItBtn,.25,{alpha:1,ease:Sine.easeOut,delay:.35}),TweenMax.to(this._colourItBtn.scale,.5,{x:1,y:1,ease:Elastic.easeOut,delay:.35})}},{key:"_onColourGalleryButton_Click",value:function(){d["default"].selectedGallery=d["default"].GALLERY_ID_COLOUR_IT,this.signals.next.dispatch(this)}},{key:"_onDrawGalleryButton_Click",value:function(){d["default"].selectedGallery=d["default"].GALLERY_ID_DRAW_IT,this.signals.next.dispatch(this)}}]),e}(p["default"]);i["default"]=f},{"../Common":3,"../CommonGame":4,"./SimpleScene":32}],28:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function S(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:S(a,e,i)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(i)},u=t("../Common"),h=n(u),_=t("../CommonGame"),d=n(_),c=t("../game/MyGame"),p=n(c),f=t("../game/Tutorial"),g=n(f),y=t("../ui/overlays/MenuPanel"),m=n(y),w=t("../ui/overlays/PalettePanel"),T=n(w),x=t("../game/PaletteButton"),I=(n(x),t("./SimpleScene")),v=n(I),P=function(t){function e(){a(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._menuPanel=null,t._tutorial=null,t._gameLayer=null,t._tutorialLayer=null,t._overlayLayer=null,t}return s(e,t),r(e,[{key:"init",value:function(){this._bgSprite=new PIXI.Sprite(h["default"].assets.getTexture("bg")),l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this._gameLayer=new PIXI.Container,this.addChild(this._gameLayer),this._tutorialLayer=new PIXI.Container,this.addChild(this._tutorialLayer),this._overlayLayer=new PIXI.Container,this.addChild(this._overlayLayer),this._menuPanel=new m["default"](this.signals),this._menuPanel.position=new PIXI.Point(.5*h["default"].STAGE_WIDTH,.5*h["default"].STAGE_HEIGHT),this._menuPanel.init(),this._overlayLayer.addChild(this._menuPanel),this._palettePanel=new T["default"],this._palettePanel.position=new PIXI.Point(.5*h["default"].STAGE_WIDTH,.5*h["default"].STAGE_HEIGHT),this._palettePanel.init(),this._overlayLayer.addChild(this._palettePanel),h["default"].game=new p["default"],h["default"].game.scene=this,h["default"].game.init(),(h["default"].savedData.isDrawTutorial||h["default"].savedData.isToolTutorial||h["default"].savedData.isPaletteTutorial)&&(this._tutorial=new g["default"],this._tutorial.init(),this._tutorial.signals.onCompleted.addOnce(function(){this._tutorial.end(),this._tutorial.destroy(),this._tutorial=null},this),this._tutorialLayer.addChild(this._tutorial)),h["default"].game.hud.signals.onMenuClick.add(this._onMenuBtn_Click,this),h["default"].game.hud.signals.onPaletteClick.add(this._onPaletteBtn_Click,this),this.createSharedControls()}},{key:"update",value:function(){this._tutorial&&this._tutorial.update(),h["default"].game.update()}},{key:"animateIn",value:function(){h["default"].audio.stopMusic(),h["default"].audio.playMusic("sfx_ambient_desert_loop_00"),h["default"].game.animateIn()}},{key:"resize",value:function(){this.x=.5*(P3.View.width-h["default"].STAGE_WIDTH),h["default"].game.resize(),this._tutorial&&this._tutorial.resize()}},{key:"addTutorialEvent",value:function(t){this._tutorial&&this._tutorial.addEvent(t)}},{key:"_onMenuBtn_Click",value:function(){this._menuPanel.show()}},{key:"_onPaletteBtn_Click",value:function(t){this._palettePanel.show(t),h["default"].game.scene.addTutorialEvent(d["default"].TUT_EVENT.PALETTE_SELECTED)}},{key:"gameLayer",get:function(){return this._gameLayer}},{key:"palettePanel",get:function(){return this._palettePanel}}]),e}(v["default"]);i["default"]=P},{"../Common":3,"../CommonGame":4,"../game/MyGame":18,"../game/PaletteButton":19,"../game/Tutorial":23,"../ui/overlays/MenuPanel":37,"../ui/overlays/PalettePanel":38,"./SimpleScene":32}],29:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function m(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:m(a,e,i)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(i)},u=t("../Common"),h=n(u),_=t("../CommonGame"),d=n(_),c=t("./SimpleScene"),p=n(c),f=t("../ui/UICarousel"),g=n(f),y=function(t){function e(){a(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.ARR_DRAW_IT_TEXT_ID=["1","2","3","4","5","6","7","8","9","10"],t.ARR_IMAGE_SPRITE_ID=[],t._imageLength=t.ARR_DRAW_IT_TEXT_ID.length;for(var i=0;i<t._imageLength;i++)t.ARR_IMAGE_SPRITE_ID.push("image_"+(i+1));return t._titleSprite=null,t._titleText=null,t._playBtn=null,t._prevImageBtn=null,t._nextImageBtn=null,t._uiCarousel=null,t}return s(e,t),r(e,[{key:"init",value:function(){this._bgSprite=new PIXI.Sprite(h["default"].assets.getTexture("bg")),l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this.imagePrefix=d["default"].selectedGallery==d["default"].GALLERY_ID_COLOUR_IT?"colour_":"draw_";for(var t=[],i=0;i<this._imageLength;i++){var n=new PIXI.Container;n.scale=new PIXI.Point(.6,.6),n.anchor=new PIXI.Point(.5,.5),n.addChild(d["default"].createCanvasBg());var a=new PIXI.Sprite(h["default"].blankTexture);a.anchor=new PIXI.Point(.5,.5),a.width=d["default"].CANVAS_WIDTH,a.height=d["default"].CANVAS_HEIGHT,a.tint=16777215,n.addChild(a);var o="drawing";1===d["default"].selectedGallery&&(o="colouring");var s=new PIXI.Sprite(h["default"].assets.getTexture("canvas_"+o));s.anchor=new PIXI.Point(.5,.5),n.addChild(s);var r=new PIXI.Sprite(h["default"].assets.getTexture(this.imagePrefix+"image_"+(i+1)));r.anchor=new PIXI.Point(.5,.5),n.addChild(r),t.push(n)}this._uiCarousel=new g["default"],this._uiCarousel.init(t),this._uiCarousel.signals.onIndexChanged.add(this._onCarouselIndex_Changed,this),this._uiCarousel.signals.onItemSelected.add(this._onPlayButton_Click,this),this.addChild(this._uiCarousel);var u=new P3.ButtonStates(h["default"].assets.getTexture("btn_primary_large_off"),h["default"].assets.getTexture("btn_primary_large_over"),h["default"].assets.getTexture("btn_primary_large_down"),h["default"].assets.getTexture("icon_play_large_off"));this._playBtn=createButton("play_large","primary_large"),this._playBtn.anchor=new PIXI.Point(.5,.5),this._playBtn.position=new PIXI.Point(.5*h["default"].STAGE_WIDTH,.5*h["default"].STAGE_HEIGHT+220),this._playBtn.overSoundName="sfx_ui_rollover_00",this._playBtn.downSoundName="sfx_btn_play_start_doorbell_00",this._playBtn.signals.click.addOnce(this._onPlayButton_Click,this),this.addChild(this._playBtn),u=new P3.ButtonStates(h["default"].assets.getTexture("icon_next_off"),h["default"].assets.getTexture("icon_next_over"),h["default"].assets.getTexture("icon_next_down")),this._nextImageBtn=new P3.Button(u),this._nextImageBtn.anchor=new PIXI.Point(.5,.5),this._nextImageBtn.scale=new PIXI.Point(1.5,1.5),this._nextImageBtn.defaultScale=new PIXI.Point(1.5,1.5),this._nextImageBtn.position=new PIXI.Point(.5*h["default"].STAGE_WIDTH+400,.5*h["default"].STAGE_HEIGHT),this._nextImageBtn.signals.click.add(this._onNextImageButton_Click,this),this.addChild(this._nextImageBtn),u=new P3.ButtonStates(h["default"].assets.getTexture("icon_next_off"),h["default"].assets.getTexture("icon_next_over"),h["default"].assets.getTexture("icon_next_down")),this._prevImageBtn=new P3.Button(u),this._prevImageBtn.anchor=new PIXI.Point(.5,.5),this._prevImageBtn.scale=new PIXI.Point((-1.5),1.5),this._prevImageBtn.alpha=0,this._prevImageBtn.defaultScale=new PIXI.Point((-1.5),1.5),this._prevImageBtn.position=new PIXI.Point(.5*h["default"].STAGE_WIDTH-400,.5*h["default"].STAGE_HEIGHT),this._prevImageBtn.signals.click.add(this._onPrevImageButton_Click,this),this.addChild(this._prevImageBtn),this._updateUI(),l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createSharedControls",this).call(this),this._uiTopBarSharedControls.muteBtn.visible=!0,this._uiTopBarSharedControls.backBtn.visible=!0,this._uiTopBarSharedControls.signals.onBackBtn_Click.addOnce(function(){this.signals.previous.dispatch(this)},this)}},{key:"update",value:function(){this._uiCarousel.update()}},{key:"animateIn",value:function(){this._uiCarousel.animateIn(),this._playBtn.alpha=0,this._playBtn.scale=new PIXI.Point,TweenMax.to(this._playBtn,.25,{alpha:1,ease:Sine.easeOut,delay:.2}),TweenMax.to(this._playBtn.scale,.5,{x:1,y:1,ease:Elastic.easeOut,delay:.2})}},{key:"_updateUI",value:function(){this._prevImageBtn.interactive=this._uiCarousel.selectedIndex>0,TweenMax.to(this._prevImageBtn,.25,{alpha:this._prevImageBtn.interactive?1:0,ease:Sine.easeOut}),this._nextImageBtn.interactive=this._uiCarousel.selectedIndex<this._imageLength-1,TweenMax.to(this._nextImageBtn,.25,{alpha:this._nextImageBtn.interactive?1:0,ease:Sine.easeOut})}},{key:"destroy",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this,{children:!0}),TweenMax.killAll()}},{key:"_onCarouselIndex_Changed",value:function(){this._updateUI()}},{key:"_onPlayButton_Click",value:function(){d["default"].selectedImageId=this.ARR_IMAGE_SPRITE_ID[this._uiCarousel.selectedIndex],d["default"].selectedGallery===d["default"].GALLERY_ID_DRAW_IT&&(d["default"].drawItTextId=this.ARR_DRAW_IT_TEXT_ID[this._uiCarousel.selectedIndex]),this.signals.next.dispatch(this)}},{key:"_onPrevImageButton_Click",value:function(){this._uiCarousel.prev()}},{key:"_onNextImageButton_Click",value:function(){this._uiCarousel.next()}}]),e}(p["default"]);i["default"]=y},{"../Common":3,"../CommonGame":4,"../ui/UICarousel":34,"./SimpleScene":32}],30:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){
function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function f(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:f(a,e,i)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(i)},u=t("../Common"),h=n(u),_=t("../CommonGame"),d=(n(_),t("./SimpleScene")),c=n(d),p=function(t){function e(){a(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._playBtn=null,t._titleSprite=null,t}return s(e,t),r(e,[{key:"init",value:function(){this._bgSprite=new PIXI.Sprite(h["default"].assets.getTexture("splash_bg")),l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this._titleSprite=new PIXI.Sprite(h["default"].assets.getTexture("game_title")),this._titleSprite.anchor=new PIXI.Point(.5,.5),this._titleSprite.position=new PIXI.Point(.5*h["default"].STAGE_WIDTH,.5*h["default"].STAGE_HEIGHT-45),this.addChild(this._titleSprite),this._playBtn=createButton("play_large","primary_large"),this._playBtn.anchor=new PIXI.Point(.5,.5),this._playBtn.position=new PIXI.Point(.5*h["default"].STAGE_WIDTH+325,h["default"].STAGE_HEIGHT-110),this._playBtn.overSoundName="sfx_ui_rollover_00",this._playBtn.downSoundName="sfx_btn_play_start_doorbell_00",this._playBtn.signals.click.addOnce(this._onPlayButton_Click,this),this.addChild(this._playBtn),l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"createSharedControls",this).call(this,this),this._uiTopBarSharedControls.muteBtn.visible=!0}},{key:"destroy",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this,{children:!0}),TweenMax.killAll()}},{key:"animateIn",value:function(){this._playBtn.alpha=0,this._playBtn.scale=new PIXI.Point,TweenMax.to(this._playBtn,.25,{alpha:1,ease:Sine.easeOut,delay:.2}),TweenMax.to(this._playBtn.scale,.5,{x:1,y:1,ease:Elastic.easeOut,delay:.2}),h["default"].audio.playMusic("music_mainmenu_loop_00")}},{key:"_onPlayButton_Click",value:function(){this.signals.next.dispatch(this)}}]),e}(c["default"]);i["default"]=p},{"../Common":3,"../CommonGame":4,"./SimpleScene":32}],31:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){this.loaded=0,this._isPlayingAnim=!1,this._logoAnimation=null,this._bar=null,this._barOverlay=null,this._text=null,this._playButton=null,P3.Scene.call(this),this.signals.onAllLoaded=new signals.Signal}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Application"),s=n(o),r=t("../Common"),l=n(r);i["default"]=a,a.prototype=Object.create(P3.Scene.prototype),a.prototype.constructor=a,a.prototype.init=function(){console.log(l["default"]),console.log(l["default"].assets);var t=new PIXI.Graphics;t.beginFill(8859527),t.drawRect(0,0,l["default"].STAGE_WIDTH,l["default"].STAGE_HEIGHT),t.endFill(),this.addChild(t);var e=new PIXI.Container;e.x=Math.floor(.5*l["default"].STAGE_WIDTH),e.y=Math.floor(.5*l["default"].STAGE_HEIGHT)+50,this.addChild(e);var i=[l["default"].assets.getTexture("loader_animation0001"),l["default"].assets.getTexture("loader_animation0002"),l["default"].assets.getTexture("loader_animation0003"),l["default"].assets.getTexture("loader_animation0004"),l["default"].assets.getTexture("loader_animation0005"),l["default"].assets.getTexture("loader_animation0006"),l["default"].assets.getTexture("loader_animation0007"),l["default"].assets.getTexture("loader_animation0008"),l["default"].assets.getTexture("loader_animation0009"),l["default"].assets.getTexture("loader_animation0010")];this._logoAnimation=new PIXI.extras.MovieClip(i),this._logoAnimation.animationSpeed=.4,this._logoAnimation.gotoAndStop(0),this._logoAnimation.stop(),this._logoAnimation.loop=!1,this._logoAnimation.anchor.x=.5,this._logoAnimation.anchor.y=1,this._logoAnimation.x+=50,this._logoAnimation.y-=20,e.addChild(this._logoAnimation),this._bar=new PIXI.Sprite(l["default"].assets.getTexture("preloader_bar")),this._bar.anchor.y=.5,this._bar.x-=.5*this._bar.width,this._bar.scale.x=0,e.addChild(this._bar),this._barOverlay=new PIXI.Sprite(l["default"].assets.getTexture("preloader_overlay")),this._barOverlay.anchor.y=.5,this._barOverlay.x-=.5*this._barOverlay.width,e.addChild(this._barOverlay),this._text=new PIXI.Text("0%",{font:"28px Arial",fill:"#FFFFFF"}),this._text.anchor.x=.5,this._text.position.y+=50,e.addChild(this._text),this._logoAnimation.gotoAndPlay(0);var n=new P3.ButtonStates(l["default"].assets.getTexture("btn_primary_large_off"),l["default"].assets.getTexture("btn_primary_large_over"),l["default"].assets.getTexture("btn_primary_large_down"),l["default"].assets.getTexture("icon_play_large_off"));this._playButton=new P3.Button(n),this._playButton.y+=50,this._playButton.visible=!1,this._playButton.signals.click.add(this._onPlayButtonClick,this),e.addChild(this._playButton)},a.prototype.destroy=function(){P3.Scene.prototype.destroy.call(this)},a.prototype.appear=function(){this.animateIn()},a.prototype.show=function(){},a.prototype.animateIn=function(t,e){},a.prototype.animateOut=function(t,e){},a.prototype.resize=function(){this.x=.5*(P3.View.width-l["default"].STAGE_WIDTH)},a.prototype.update=function(){this._bar.scale.x=this.loaded,this._text.text=Math.floor(100*this._bar.scale.x)+"%",1==this.loaded&&(P3.Device.isMobile?this._playButton.visible||(this._playButton.visible=!0,this._playButton.alpha=0,TweenMax.to(this._playButton,.25,{alpha:1,ease:Sine.easeOut}),TweenMax.to(this._bar,.25,{alpha:0,ease:Sine.easeIn}),TweenMax.to(this._barOverlay,.25,{alpha:0,ease:Sine.easeIn}),TweenMax.to(this._text,.25,{alpha:0,ease:Sine.easeIn})):this.signals.onAllLoaded.dispatch(this))},a.prototype._onPlayButtonClick=function(t){this._playButton.interactive=!1,P3.Device.isAndroid&&screenfull.enabled&&(screenfull.request(),setTimeout(function(){l["default"].view.resize()},1e3)),TweenMax.to(this._playButton,.25,{alpha:0,ease:Sine.easeIn,onComplete:s["default"].init,onCompleteScope:this})}},{"../Application":2,"../Common":3}],32:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function f(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:f(a,e,i)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(i)},u=t("../Common"),h=n(u),_=t("../CommonGame"),d=(n(_),t("../ui/UITopBarSharedControls")),c=n(d),p=function(t){function e(){a(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._uiTopBarSharedControls=null,t._bgSprite=null,t}return s(e,t),r(e,[{key:"init",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),null!=this._bgSprite&&(this._bgSprite.anchor=new PIXI.Point(.5,.5),this._bgSprite.position=new PIXI.Point(.5*h["default"].STAGE_WIDTH,.5*h["default"].STAGE_HEIGHT),this.addChild(this._bgSprite))}},{key:"createSharedControls",value:function(){this._uiTopBarSharedControls=new c["default"],this._uiTopBarSharedControls.init(),this.addChild(this._uiTopBarSharedControls)}},{key:"resize",value:function(){this.x=.5*(P3.View.width-h["default"].STAGE_WIDTH),this._uiTopBarSharedControls.resize()}},{key:"destroy",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.children=!0,l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"destroy",this).call(this,t),TweenMax.killAll()}},{key:"animateIn",value:function(t,e){throw new Error("You have to implement the abstract method before use : "+this.constructor.name+"#animateIn")}},{key:"animateOut",value:function(t,e){throw new Error("You have to implement the abstract method before use : "+this.constructor.name+"animateOut")}},{key:"bg",get:function(){return this._bgSprite}}]),e}(P3.Scene);i["default"]=p,Object.defineProperty(p.prototype,"bg",{get:function(){return this._bgSprite}})},{"../Common":3,"../CommonGame":4,"../ui/UITopBarSharedControls":35}],33:[function(t,e,i){"use strict";function n(t,e){t=t||1,PIXI.Filter.call(this,"attribute vec2 aVertexPosition;attribute vec2 aTextureCoord;uniform mat3 projectionMatrix;varying vec2 vTextureCoord;void main(void){gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);vTextureCoord = aTextureCoord;}","varying vec2 vTextureCoord;uniform sampler2D uSampler;uniform float thickness;uniform vec4 outlineColor;uniform vec4 filterArea;uniform vec4 filterClamp;vec2 px = vec2(1.0 / filterArea.x, 1.0 / filterArea.y);void main(void) {const float PI = 3.14159265358979323846264;vec4 ownColor = texture2D(uSampler, vTextureCoord);vec4 curColor;float maxAlpha = 0.;vec2 displaced;for (float angle = 0.; angle < PI * 2.; angle += %THICKNESS% ) {displaced.x = vTextureCoord.x + thickness * px.x * cos(angle);displaced.y = vTextureCoord.y + thickness * px.y * sin(angle);curColor = texture2D(uSampler, clamp(displaced, filterClamp.xy, filterClamp.zw));maxAlpha = max(maxAlpha, curColor.a);}float resultAlpha = max(maxAlpha, ownColor.a);gl_FragColor = vec4((ownColor.rgb + outlineColor.rgb * (1. - ownColor.a)) * resultAlpha, resultAlpha); }".replace(/%THICKNESS%/gi,(1/t).toFixed(7))),this.uniforms.thickness=t,this.uniforms.outlineColor=new Float32Array([0,0,0,1]),e&&(this.color=e)}n.prototype=Object.create(PIXI.Filter.prototype),n.prototype.constructor=n,e.exports=n,Object.defineProperties(n.prototype,{color:{get:function(){return PIXI.utils.rgb2hex(this.uniforms.outlineColor)},set:function(t){PIXI.utils.hex2rgb(t,this.uniforms.outlineColor)}}})},{}],34:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(){PIXI.Container.call(this),this.PAGE_WIDTH=800,this.DEFAULT_ITEM_SCALE=0,this.UNSELECTED_ITEM_SCALE_DELTA=.1,this.SELECTED_ITEM_EXIT_EASE_FACTOR=.2,this._pageContainer=null,this._interactiveArea=null,this._mask=null,this._startX=0,this._lastX=0,this._currentX=0,this._itemIndex=0,this.signals={},this.signals.onIndexChanged=new signals.Signal,this.signals.onItemSelected=new signals.Signal}Object.defineProperty(i,"__esModule",{value:!0});var o=t("../Common"),s=n(o),r=t("../CommonGame");n(r);i["default"]=a,a.prototype=Object.create(PIXI.Container.prototype),a.prototype.constructor=a,a.prototype.init=function(t){this.position=new PIXI.Point(.5*s["default"].STAGE_WIDTH,.5*s["default"].STAGE_HEIGHT),this._mask=new PIXI.Graphics,this._mask.beginFill(16777215,0),this._mask.drawRect(.5*-s["default"].STAGE_WIDTH,.5*-s["default"].STAGE_HEIGHT,s["default"].STAGE_WIDTH,s["default"].STAGE_HEIGHT),this._mask.endFill(),this.addChild(this._mask),this._interactiveArea=new PIXI.Sprite(s["default"].blankTexture),this._interactiveArea.tint=16777215,this._interactiveArea.alpha=0,this._interactiveArea.height=400,this._interactiveArea.width=s["default"].STAGE_WIDTH,this._interactiveArea.anchor=new PIXI.Point(.5,.5),this._interactiveArea.buttonMode=!0,this._interactiveArea.interactive=!0,this._interactiveArea.mousedown=this._interactiveArea.touchstart=this._onMouseDown.bind(this),this._interactiveArea.mouseup=this._interactiveArea.touchend=this._onMouseUp.bind(this),this._interactiveArea.mouseupoutside=this._interactiveArea.touchendoutside=this._onMouseUp.bind(this),this.addChild(this._interactiveArea),this._pageContainer=new PIXI.Container,this._pageContainer.anchor=new PIXI.Point(.5,.5),this._pageContainer.mask=this._mask,this._pageContainer.x=.5*-this.PAGE_WIDTH,this.addChild(this._pageContainer);var e=0,i=!0,n=!1,a=void 0;try{for(var o,r=t[Symbol.iterator]();!(i=(o=r.next()).done);i=!0){var l=o.value;0==this.DEFAULT_ITEM_SCALE&&(this.DEFAULT_ITEM_SCALE=l.scale.x);var u=new PIXI.Container;u.anchor=new PIXI.Point(0,.5),this._pageContainer.addChild(u);var h=new PIXI.Sprite(s["default"].blankTexture);h.alpha=0,h.anchor=new PIXI.Point(0,.5),h.width=this.PAGE_WIDTH,h.height=l.height,u.addChild(h),l.x=.5*l.width+.5*(h.width-l.width),u.addChild(l),e>0&&(l.scale=new PIXI.Point(this.DEFAULT_ITEM_SCALE-this.UNSELECTED_ITEM_SCALE_DELTA,this.DEFAULT_ITEM_SCALE-this.UNSELECTED_ITEM_SCALE_DELTA)),u.x=e*u.width,++e}}catch(_){n=!0,a=_}finally{try{!i&&r["return"]&&r["return"]()}finally{if(n)throw a}}},a.prototype.update=function(){this._updateItemHiglighting()},a.prototype.animateIn=function(){this._pageContainer.children[0].y-=100,this._pageContainer.children[0].alpha=0,TweenMax.to(this._pageContainer.children[0],.25,{alpha:1,y:this._pageContainer.children[0].y+100,ease:Sine.easeOut})},a.prototype.next=function(){this._itemIndex<this._pageContainer.children.length-1&&(this._itemIndex+=1,TweenMax.to(this._pageContainer,.25,{x:-this._itemIndex*this.PAGE_WIDTH-.5*this.PAGE_WIDTH,ease:Sine.easeInOut,onComplete:function(){this.signals.onIndexChanged.dispatch()},onCompleteScope:this}),s["default"].audio.playSound("sfx_ui_carousel_swipe_00"))},a.prototype.prev=function(){this._itemIndex>0&&(this._itemIndex-=1,TweenMax.to(this._pageContainer,.25,{x:-this._itemIndex*this.PAGE_WIDTH-.5*this.PAGE_WIDTH,ease:Sine.easeInOut,onComplete:function(){this.signals.onIndexChanged.dispatch()},onCompleteScope:this}),s["default"].audio.playSound("sfx_ui_carousel_swipe_00"))},a.prototype._updateItemHiglighting=function(){var t=Math.abs(this._pageContainer.x)/this.PAGE_WIDTH,e=Math.floor(t);this._itemIndex==e&&(Math.abs(this._itemIndex-t)<=.5-this.SELECTED_ITEM_EXIT_EASE_FACTOR&&this._itemIndex>0?e-=1:Math.abs(this._itemIndex-t)>=.5+this.SELECTED_ITEM_EXIT_EASE_FACTOR&&this._itemIndex<this._pageContainer.children.length-1&&(e+=1));var i=0,n=!0,a=!1,o=void 0;try{for(var s,r=this._pageContainer.children[Symbol.iterator]();!(n=(s=r.next()).done);n=!0){var l=s.value,u=l.children[1];TweenMax.isTweening(u.scale)||(i==e&&u.scale.x!=this.DEFAULT_ITEM_SCALE?TweenMax.to(u.scale,.12,{x:this.DEFAULT_ITEM_SCALE,y:this.DEFAULT_ITEM_SCALE,ease:Sine.easeInOut}):i!=e&&u.scale.x!=this.DEFAULT_ITEM_SCALE-this.UNSELECTED_ITEM_SCALE_DELTA&&TweenMax.to(u.scale,.12,{x:this.DEFAULT_ITEM_SCALE-this.UNSELECTED_ITEM_SCALE_DELTA,y:this.DEFAULT_ITEM_SCALE-this.UNSELECTED_ITEM_SCALE_DELTA,ease:Sine.easeInOut})),++i}}catch(h){a=!0,o=h}finally{try{!n&&r["return"]&&r["return"]()}finally{if(a)throw o}}},a.prototype._snap=function(){var t=Math.abs(this._pageContainer.x)/this.PAGE_WIDTH,e=Math.floor(t);e==this._itemIndex&&(Math.abs(e-t)<=.5-this.SELECTED_ITEM_EXIT_EASE_FACTOR&&e>0?e-=1:Math.abs(e-t)>=.5+this.SELECTED_ITEM_EXIT_EASE_FACTOR&&e<this._pageContainer.children.length-1&&(e+=1)),TweenMax.to(this._pageContainer,.25,{x:-e*this.PAGE_WIDTH-.5*this.PAGE_WIDTH,ease:Sine.easeInOut,onComplete:function(t){this._itemIndex=t,this.signals.onIndexChanged.dispatch()},onCompleteScope:this,onCompleteParams:[e]})},a.prototype._onMouseDown=function(t){TweenMax.killTweensOf(this._pageContainer);var e=t.data.getLocalPosition(this._interactiveArea);this._startX=e.x,this._lastX=this._startX,this._currentX=this._startX,this._interactiveArea.mousemove=this._interactiveArea.touchmove=this._onMouseMove.bind(this)},a.prototype._onMouseMove=function(t){var e=t.data.getLocalPosition(this._interactiveArea);this._currentX=e.x,this._pageContainer.x+=(this._currentX-this._lastX)*s["default"].STAGE_WIDTH,this._pageContainer.x>.5*-this.PAGE_WIDTH?this._pageContainer.x=.5*-this.PAGE_WIDTH:this._pageContainer.x<-(this._pageContainer.children.length-.5)*this.PAGE_WIDTH&&(this._pageContainer.x=-(this._pageContainer.children.length-.5)*this.PAGE_WIDTH),this._lastX=this._currentX},a.prototype._onMouseUp=function(t){var e=!1;if(Math.abs(this._startX-this._currentX)<=.01){var i=this._pageContainer.children[this._itemIndex].children[1],n=t.data.getLocalPosition(i);Math.abs(n.x)<=.8*i.width&&Math.abs(n.y)<=.8*i.height&&(this.signals.onItemSelected.dispatch(),e=!0)}e||(this._interactiveArea.mousemove=this._interactiveArea.touchmove=null,this._snap(),s["default"].audio.playSound("sfx_ui_carousel_swipe_00"))},Object.defineProperty(a.prototype,"selectedIndex",{get:function(){return this._itemIndex}})},{"../Common":3,"../CommonGame":4}],35:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../Common"),u=n(l),h=t("../CommonGame"),_=n(h),d=function(t){function e(){a(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._homeBtn=null,t._muteBtn=null,t._backBtn=null,t.signals={},t.signals.onBackBtn_Click=new signals.Signal,t}return s(e,t),r(e,[{key:"init",value:function(){this._homeBtn=createButton("home"),this._homeBtn.anchor=new PIXI.Point(0,.5),this._homeBtn.position.y=.5*this._homeBtn.height+30,this._homeBtn.visible=!1,this._homeBtn._icon.scale.x=-1,this._homeBtn.overSoundName="sfx_ui_rollover_00",this._homeBtn.downSoundName="sfx_ui_click_00",this._homeBtn.signals.click.add(this._onHomeButton_Click,this),this.addChild(this._homeBtn),this._muteBtn=createButton("sound"),this._muteBtn.anchor=new PIXI.Point(1,.5),this._muteBtn.position.y=this._homeBtn.position.y,this._muteBtn.visible=!1,this._muteBtn.overSoundName="sfx_ui_rollover_00",this._muteBtn.downSoundName="sfx_ui_click_00",this._muteBtn.signals.click.add(this._onMuteButton_Click,this),this.addChild(this._muteBtn),this._backBtn=createButton("back"),this._backBtn.anchor=new PIXI.Point(0,.5),this._backBtn.position.y=this._homeBtn.position.y,this._backBtn.overSoundName="sfx_ui_rollover_00",this._backBtn.downSoundName="sfx_ui_click_00",this._backBtn.signals.click.add(this._onBackButton_Click,this),this._backBtn.visible=!1,this.addChild(this._backBtn)}},{key:"resize",value:function(){this._homeBtn.position.x=u["default"].getScreenPositionLeft()+70,this._muteBtn.position.x=u["default"].getScreenPositionRight()-70,this._backBtn.position.x=u["default"].getScreenPositionLeft()+70}},{key:"_onHomeButton_Click",value:function(){u["default"].main.application.loadScene(_["default"].SCENE_ID_MAIN)}},{key:"_onMuteButton_Click",value:function(){u["default"].isMute=!u["default"].isMute,this._muteBtn._icon.texture=u["default"].assets.getTexture(u["default"].isMute?"icon_mute_off":"icon_sound_off"),this._muteBtn._currentIconTexture=this._muteBtn._icon.texture,u["default"].audio.mute(u["default"].isMute)}},{key:"_onBackButton_Click",value:function(){this.signals.onBackBtn_Click.dispatch()}},{key:"homeBtn",get:function(){return this._homeBtn}},{key:"muteBtn",get:function(){return this._muteBtn}},{key:"backBtn",get:function(){return this._backBtn}}]),e}(PIXI.Container);i["default"]=d},{"../Common":3,"../CommonGame":4}],36:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../../Common"),u=n(l),h=t("../../CommonGame"),_=(n(h),function(t){function e(){a(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._bgSprite=null,t._messageSprite=null,t._messageText=null,t._yesBtn=null,t._noBtn=null,t._selectedBtn=null,t.signals={},t.signals.onYes=new signals.Signal,t.signals.onNo=new signals.Signal,t}return s(e,t),r(e,[{key:"init",value:function(){this._bgSprite=new PIXI.Sprite(u["default"].blankTexture),this._bgSprite.anchor=new PIXI.Point(.5,.5),this._bgSprite.tint=0,this._bgSprite.alpha=.3,this._bgSprite.interactive=!0,this._bgSprite.width=u["default"].STAGE_WIDTH,this._bgSprite.height=u["default"].STAGE_HEIGHT,this.addChild(this._bgSprite),this._messageSprite=new PIXI.Sprite(u["default"].assets.getTexture("colour_palette_big_bg")),this._messageSprite.anchor=new PIXI.Point(.5,.5),this.addChild(this._messageSprite),this._messageText=P3.createText("COLOUR_IT",{size:"64px",fill:[16775347,16433417],stroke:24880,stokeThickness:5,wordWrap:!0,wordWrapWidth:this._messageSprite.width-200},"truetype"),this._messageText.anchor=new PIXI.Point(.5,.5),this._messageText.y=-80,this._messageSprite.addChild(this._messageText),this._yesBtn=createButton("tick","primary_large"),this._yesBtn.anchor=new PIXI.Point(.5,.5),this._yesBtn.position=new PIXI.Point(100,.5*this._messageSprite.height-110),this._yesBtn.overSoundName="sfx_ui_rollover_00",this._yesBtn.downSoundName="sfx_ui_click_00",this._messageSprite.addChild(this._yesBtn),this._noBtn=createButton("cross","primary_large"),this._noBtn.anchor=new PIXI.Point(.5,.5),this._noBtn.position=new PIXI.Point((-100),.5*this._messageSprite.height-110),this._noBtn.overSoundName="sfx_ui_rollover_00",this._noBtn.downSoundName="sfx_ui_click_00",this._messageSprite.addChild(this._noBtn),this.visible=!1}},{key:"show",value:function(t){this.visible=!0,this._messageText.text=t,this._messageSprite.alpha=0,this._messageSprite.y=-100,TweenMax.to(this._messageSprite,.25,{y:this._messageSprite.y+100,alpha:1,ease:Sine.easeOut}),this._bgSprite.alpha=0,TweenMax.to(this._bgSprite,.25,{alpha:.3,ease:Sine.easeOut}),this._noBtn.alpha=0,this._noBtn.scale=new PIXI.Point,TweenMax.to(this._noBtn,.25,{alpha:1,ease:Sine.easeOut,delay:.15}),TweenMax.to(this._noBtn.scale,.5,{x:1,y:1,ease:Elastic.easeOut,delay:.15}),this._yesBtn.alpha=0,this._yesBtn.scale=new PIXI.Point,TweenMax.to(this._yesBtn,.25,{alpha:1,ease:Sine.easeOut,delay:.3}),TweenMax.to(this._yesBtn.scale,.5,{x:1,y:1,ease:Elastic.easeOut,delay:.3}),this._yesBtn.signals.click.addOnce(function(){this._selectedBtn=this._yesBtn,this._hide()},this),this._noBtn.signals.click.addOnce(function(){this._selectedBtn=this._noBtn,this._hide()},this)}},{key:"_hide",value:function(){TweenMax.to(this._messageSprite,.25,{y:this._messageSprite.y+100,alpha:0,ease:Sine.easeIn}),TweenMax.to(this._bgSprite,.25,{alpha:0,ease:Sine.easeIn,onComplete:this._onHidden,onCompleteScope:this}),this._yesBtn.signals.click.removeAll(),this._noBtn.signals.click.removeAll()}},{key:"_onHidden",value:function(){this._selectedBtn===this._yesBtn?this.signals.onYes.dispatch():this._selectedBtn===this._noBtn&&this.signals.onNo.dispatch(),this._selectedBtn=null,this.visible=!1,this.signals.onYes.removeAll(),this.signals.onNo.removeAll()}}]),e}(PIXI.Container));i["default"]=_},{"../../Common":3,"../../CommonGame":4}],37:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../../Common"),u=n(l),h=t("../../CommonGame"),_=n(h),d=t("./ConfirmationPanel"),c=n(d),p=t("./TrashConfirmationPanel"),f=n(p),g=function(t){function e(t){a(this,e);var i=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i._gameSceneSignals=t,i._quitBtn=null,i._backBtn=null,i._printBtn=null,i._downloadBtn=null,i._muteBtn=null,i._binBtn=null,i._boxBorderSprite=null,i._popupContainer=null,i._drawingActionContainer=null,i._titleSprite=null,i._bgGradientSprite=null,i._titleText=null,i._confirmationPanel=null,i._trashConfirmationPanel=null,i}return s(e,t),r(e,[{key:"init",value:function(){this._bgGradientSprite=new PIXI.Sprite(u["default"].blankTexture),this._bgGradientSprite.tint=0,this._bgGradientSprite.alpha=.6,this._bgGradientSprite.anchor=new PIXI.Point(.5,.5),this._bgGradientSprite.scale.x=1.25*u["default"].STAGE_WIDTH,this._bgGradientSprite.scale.y=u["default"].STAGE_HEIGHT,this._bgGradientSprite.interactive=!0,this._bgGradientSprite.click=this._bgGradientSprite.touchend=this._onBackButton_Click.bind(this),this.addChild(this._bgGradientSprite),this._popupContainer=new PIXI.Container,this._popupContainer.anchor=new PIXI.Point(.5,.5),this.addChild(this._popupContainer),this._boxBorderSprite=new PIXI.Sprite(u["default"].assets.getTexture("menu_panel")),this._boxBorderSprite.anchor=new PIXI.Point(.5,.5),this._popupContainer.addChild(this._boxBorderSprite),this._popupContainer.scale.set(.9,.9),this._titleSprite=new PIXI.Sprite(PIXI.Texture.EMPTY),this._titleSprite.anchor=new PIXI.Point(.5,.5),this._popupContainer.addChild(this._titleSprite);var t=P3.createText("MENU",{fill:[16775347,16433417],size:"90px",wordWrap:!0,wordWrapWidth:500,stroke:2336824,strokeThickness:14,align:"centre"});this._titleText=P3.createText("MENU",{fill:[16775347,16433417],size:"90px",wordWrap:!0,wordWrapWidth:500,stroke:24880,align:"centre",strokeThickness:8}),this._titleText.y=t.y=.5*-this._boxBorderSprite.height+145,this._titleText.anchor=t.anchor=new PIXI.Point(.5,.5),this._titleSprite.addChild(t,this._titleText),this._quitBtn=createButton("home"),this._quitBtn.anchor=new PIXI.Point(.5,.5),this._quitBtn.position=new PIXI.Point((-234),248),this._quitBtn.overSoundName="sfx_ui_rollover_00",this._quitBtn.downSoundName="sfx_ui_click_00",this._quitBtn.signals.click.add(this._onQuitButton_Click,this),this._popupContainer.addChild(this._quitBtn),this._muteBtn=createButton("sound"),this._muteBtn.anchor=new PIXI.Point(.5,.5),this._muteBtn.position=new PIXI.Point(238,248),this._muteBtn.overSoundName="sfx_ui_rollover_00",this._muteBtn.downSoundName="sfx_ui_click_00",this._muteBtn.signals.click.add(this._onSoundButton_Click,this),this._popupContainer.addChild(this._muteBtn),this._drawingActionContainer=new PIXI.Sprite(PIXI.Texture.EMPTY),this._drawingActionContainer.anchor.set(.5,.5),this._drawingActionContainer.y=-15,this._popupContainer.addChild(this._drawingActionContainer);var e=240,i=void 0;u["default"].assets.getJSON("config").menuPanel.printBtn.isVisible&&(i=new P3.ButtonStates(PIXI.Texture.EMPTY,PIXI.Texture.EMPTY,PIXI.Texture.EMPTY,u["default"].assets.getTexture("icon_print")),this._printBtn=new P3.Button(i),this._printBtn.anchor=new PIXI.Point(.5,.5),this._printBtn.x=-e,this._printBtn.signals.click.add(this._onPrintButton_Click,this),this._drawingActionContainer.addChild(this._printBtn)),u["default"].assets.getJSON("config").menuPanel.downloadBtn.isVisible&&(i=new P3.ButtonStates(PIXI.Texture.EMPTY,PIXI.Texture.EMPTY,PIXI.Texture.EMPTY,u["default"].assets.getTexture("icon_save")),this._downloadBtn=new P3.Button(i),this._downloadBtn.anchor=new PIXI.Point(.5,.5),this._downloadBtn.x=0,this._downloadBtn.signals.click.add(this._onDownloadButton_Click,this),this._drawingActionContainer.addChild(this._downloadBtn)),u["default"].assets.getJSON("config").menuPanel.binBtn.isVisible&&(i=new P3.ButtonStates(PIXI.Texture.EMPTY,PIXI.Texture.EMPTY,PIXI.Texture.EMPTY,u["default"].assets.getTexture("icon_replay")),this._binBtn=new P3.Button(i),this._binBtn.anchor=new PIXI.Point(.5,.5),this._binBtn.x=e,this._binBtn.signals.click.add(this._onBinButton_Click,this),this._drawingActionContainer.addChild(this._binBtn)),this._backBtn=createButton("play_large","primary_large"),this._backBtn.anchor=new PIXI.Point(.5,.5),this._backBtn.position=new PIXI.Point(0,.5*this._boxBorderSprite.height-115),this._backBtn.overSoundName="sfx_ui_rollover_00",this._backBtn.downSoundName="sfx_ui_click_00",this._backBtn.signals.click.add(this._onBackButton_Click,this),this._popupContainer.addChild(this._backBtn),this._confirmationPanel=new c["default"],this._confirmationPanel.anchor=new PIXI.Point(.5,.5),this._confirmationPanel.init(),this.addChild(this._confirmationPanel),this._trashConfirmationPanel=new f["default"],this._trashConfirmationPanel.anchor=new PIXI.Point(.5,.5),this._trashConfirmationPanel.init(),this.addChild(this._trashConfirmationPanel),this.visible=!1,this.alpha=0}},{key:"show",value:function(){this.visible=!0,this._popupContainer.y=-50,TweenMax.to(this,.25,{alpha:1,ease:Quad.easeOut}),TweenMax.to(this._popupContainer,.25,{y:0,ease:Quad.easeOut}),this._backBtn.alpha=0,this._backBtn.scale=new PIXI.Point,TweenMax.to(this._backBtn,.25,{alpha:1,ease:Sine.easeOut,delay:.2}),TweenMax.to(this._backBtn.scale,.5,{x:1,y:1,ease:Elastic.easeOut,delay:.2}),u["default"].game.scene.addTutorialEvent(_["default"].TUT_EVENT.MENU_PANEL_SHOWN)}},{key:"_onQuitButton_Click",value:function(){var t=this;this._confirmationPanel.signals.onYes.addOnce(function(){u["default"].audio.stopMusic(),u["default"].audio.playMusic("music_mainmenu_loop_00"),t._gameSceneSignals.previous.dispatch(t)},this),this._confirmationPanel.show(u["default"].assets.getJSON("languages").LEAVE_CONFIRMATION[u["default"].language])}},{key:"_onPrintButton_Click",value:function(){var t=this;u["default"].audio.playSound("sfx_ui_newpage_00"),this.visible=!1,u["default"].game.hud.visible=!1,setTimeout(function(){var e=u["default"].renderer.extract.canvas(u["default"].game.canvas);if(i){i.document.body.appendChild(e);var n="@page { size: landscape; margin-top: 1.4cm; margin-left: 2.3cm; }",a=i.document.head||i.document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",o.media="print",o.styleSheet?o.styleSheet.cssText=n:o.appendChild(document.createTextNode(n)),a.appendChild(o),i.print(),i.close()}else console.error("unable to open new window"),console.log(i);
t.visible=!0,u["default"].game.hud.visible=!0},2.5)}},{key:"_onDownloadButton_Click",value:function(){var t=this;u["default"].audio.playSound("sfx_ui_folder_save_00"),this.visible=!1,u["default"].game.hud.visible=!1,setTimeout(function(){var e=u["default"].renderer.extract.canvas(u["default"].game.canvas);null!=i&&i.document.body.appendChild(e),t.visible=!0,u["default"].game.hud.visible=!0},2.5)}},{key:"_onSoundButton_Click",value:function(){u["default"].isMute=!u["default"].isMute,this._muteBtn._icon.texture=u["default"].assets.getTexture(u["default"].isMute?"icon_mute_off":"icon_sound_off"),this._muteBtn._currentIconTexture=this._muteBtn._icon.texture,u["default"].audio.mute(u["default"].isMute)}},{key:"_onBinButton_Click",value:function(){this._trashConfirmationPanel.signals.onYes.addOnce(function(){u["default"].audio.playSound("sfx_tool_trashcan_select_00"),u["default"].game.canvas.clear(),u["default"].game.undoManager.clear(),this.visible=!1},this),this._trashConfirmationPanel.show(u["default"].assets.getJSON("languages").BIN_CONFIRMATION[u["default"].language])}},{key:"_onBackButton_Click",value:function(){TweenMax.to(this,.25,{alpha:0,ease:Quad.easeOut}),TweenMax.to(this._popupContainer,.25,{y:50,ease:Quad.easeOut,onComplete:function(){this.visible=!1,u["default"].game.scene.addTutorialEvent(_["default"].TUT_EVENT.MENU_PANEL_HIDDEN)},onCompleteScope:this})}}]),e}(PIXI.Container);i["default"]=g},{"../../Common":3,"../../CommonGame":4,"./ConfirmationPanel":36,"./TrashConfirmationPanel":39}],38:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=t("../../Common"),u=n(l),h=t("../../CommonGame"),_=n(h),d=function(t){function e(){a(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.ITEMS_PER_ROW=5,t.ITEMS_PER_PAGE=15,t.PALETTE_TOOLS=u["default"].assets.getJSON("config").palettePanel.tools,t.PALETTE_TYPE_TO_TOOL=[t.PALETTE_TOOLS.pencil,t.PALETTE_TOOLS.brush,t.PALETTE_TOOLS.stamp,t.PALETTE_TOOLS.fill,t.PALETTE_TOOLS.ink,t.PALETTE_TOOLS.spray,t.PALETTE_TOOLS.fill],t._bgGradientSprite=null,t._panel=null,t._boxSprite=null,t._type=null,t._nextBtn=null,t._prevBtn=null,t._pageIndex=0,t._pageCount=0,t._arrBtnInfo=[],t.signals={},t.signals.onColourChanged=new signals.Signal,t.signals.onStampChanged=new signals.Signal,t}return s(e,t),r(e,[{key:"init",value:function(){this._bgGradientSprite=new PIXI.Sprite(u["default"].blankTexture),this._bgGradientSprite.tint=0,this._bgGradientSprite.alpha=.6,this._bgGradientSprite.anchor=new PIXI.Point(.5,.5),this._bgGradientSprite.scale.x=1.25*u["default"].STAGE_WIDTH,this._bgGradientSprite.scale.y=u["default"].STAGE_HEIGHT,this._bgGradientSprite.interactive=!0,this._bgGradientSprite.click=this._bgGradientSprite.touchend=this.hide.bind(this),this.addChild(this._bgGradientSprite),this._panel=new PIXI.Container,this.addChild(this._panel),this._boxSprite=new PIXI.Sprite(u["default"].assets.getTexture("colour_palette_big_bg")),this._boxSprite.interactive=!0,this._boxSprite.anchor=new PIXI.Point(.5,.5),this._panel.addChild(this._boxSprite);var t=new P3.ButtonStates(u["default"].assets.getTexture("icon_next_off"),u["default"].assets.getTexture("icon_next_over"),u["default"].assets.getTexture("icon_next_down"));this._nextBtn=new P3.Button(t),this._nextBtn.anchor=new PIXI.Point(.5,.5),this._nextBtn.scale=new PIXI.Point(1.5,1.5),this._nextBtn.defaultScale=new PIXI.Point(1.5,1.5),this._nextBtn.position.x=.5*this._boxSprite.width+50,this._nextBtn.alpha=0,this._nextBtn.interactive=!1,this._nextBtn.signals.click.add(this._onNextButton_Click,this),this._panel.addChild(this._nextBtn),t=new P3.ButtonStates(u["default"].assets.getTexture("icon_next_off"),u["default"].assets.getTexture("icon_next_over"),u["default"].assets.getTexture("icon_next_down")),this._prevBtn=new P3.Button(t),this._prevBtn.anchor=new PIXI.Point(.5,.5),this._prevBtn.scale=new PIXI.Point((-1.5),1.5),this._prevBtn.defaultScale=new PIXI.Point((-1.5),1.5),this._prevBtn.position.x=.5*-this._boxSprite.width-50,this._prevBtn.alpha=0,this._prevBtn.interactive=!1,this._prevBtn.signals.click.add(this._onPrevButton_Click,this),this._panel.addChild(this._prevBtn),this.visible=!1}},{key:"show",value:function(t){this._type=t,this._arrBtnInfo=this._findItems(this._type),this._pageIndex=0,this._updateNavControls(),this._createItems(this._arrBtnInfo),this.visible=!0,this.alpha=0,this._panel.y=-50,TweenMax.to(this._panel,.25,{y:0,ease:Quad.easeOut}),TweenMax.to(this,.25,{alpha:1,ease:Quad.easeOut}),u["default"].audio.playSound("sfx_palette_select_00")}},{key:"changeType",value:function(t){this._type!==t&&(this._type=t,this._removeItems(),this._pageIndex=0,this._arrBtnInfo=this._findItems(this._type),this._updateNavControls(),this._createItems(this._arrBtnInfo))}},{key:"hide",value:function(){TweenMax.to(this._panel,.25,{y:50,ease:Quad.easeOut}),TweenMax.to(this,.25,{alpha:0,ease:Quad.easeOut,onComplete:function(){this.visible=!1,this._boxSprite.removeChildren(),u["default"].game.scene.addTutorialEvent(_["default"].TUT_EVENT.PALETTE_PANEL_HIDDEN)},onCompleteScope:this}),u["default"].audio.playSound("sfx_palette_close_00")}},{key:"_removeItems",value:function(){var t=!0,e=!1,i=void 0;try{for(var n,a=this._boxSprite.children[Symbol.iterator]();!(t=(n=a.next()).done);t=!0){var o=n.value;o.interactive=!1,TweenMax.to(o.scale,.2,{x:0,y:0,ease:Sine.easeIn,delay:.2*Math.random(),onComplete:function(t){this._boxSprite.removeChild(t)},onCompleteScope:this,onCompleteParams:[o]})}}catch(s){e=!0,i=s}finally{try{!t&&a["return"]&&a["return"]()}finally{if(e)throw i}}}},{key:"_findItems",value:function(t){var e=[],i=u["default"].assets.getJSON("config").palettePanel.pages,n=this.PALETTE_TYPE_TO_TOOL[t],a=!0,o=!1,s=void 0;try{for(var r,l=n[Symbol.iterator]();!(a=(r=l.next()).done);a=!0){var h=r.value;e.push([]);var d=!0,c=!1,p=void 0;try{for(var f,g=i[h][Symbol.iterator]();!(d=(f=g.next()).done);d=!0){var y=f.value;if(0==y.indexOf("#"))e[e.length-1].push({out:"btns_colour_white",over:"btns_colour_white",down:"btns_colour_white",tint:parseInt("0x"+y.substring(1)),isShine:!0});else if(y.indexOf(_["default"].TEXTURE_SPRITE_BASE_ID)!=-1){var m=_["default"].TEXTURE_BUTTON_BASE_ID+y.substring(y.length-2);e[e.length-1].push({out:m,over:m,down:m,isShine:!0})}else e[e.length-1].push({out:y,over:y,down:y,isShine:!1})}}catch(w){c=!0,p=w}finally{try{!d&&g["return"]&&g["return"]()}finally{if(c)throw p}}}}catch(w){o=!0,s=w}finally{try{!a&&l["return"]&&l["return"]()}finally{if(o)throw s}}return e}},{key:"_createItems",value:function(t){var e=this._arrBtnInfo[this._pageIndex],i=0,n=0,a=0,o=7,s=Math.ceil(e.length/this.ITEMS_PER_ROW),r=.5*-this._boxSprite.width+.5*(this._boxSprite.width-135*this._findItemCount(a,e.length)+125),l=.5*-this._boxSprite.height+.5*(this._boxSprite.height-130*(s-1)),h=!0,_=!1,d=void 0;try{for(var c,p=e[Symbol.iterator]();!(h=(c=p.next()).done);h=!0){var f=c.value,g=new P3.ButtonStates(u["default"].assets.getTexture(f.out),u["default"].assets.getTexture(f.over),u["default"].assets.getTexture(f.down)),y=new P3.Button(g);if(y.tint=null!=f.tint?f.tint:16777215,y.anchor=new PIXI.Point(.5,.5),y.x=r+135*n,y.y=l+125*a,n%2!=0&&(y.y+=o,o*=-1),y.index=i,y.signals.click.addOnce(this._onMenuButton_Click,this),this._boxSprite.addChild(y),f.isShine){var m=new PIXI.Sprite(u["default"].assets.getTexture("btns_colour_overlay"));m.anchor=new PIXI.Point(.5,.5),m.alpha=.4,m.blendMode=PIXI.BLEND_MODES.ADD,y.addChild(m)}++i,++n,n>=this.ITEMS_PER_ROW&&(n=0,++a,r=.5*-this._boxSprite.width+.5*(this._boxSprite.width-135*this._findItemCount(a,e.length)+125)),y.scale=new PIXI.Point,TweenMax.to(y.scale,.2,{x:1,y:1,ease:Sine.easeOut,delay:.2*Math.random()})}}catch(w){_=!0,d=w}finally{try{!h&&p["return"]&&p["return"]()}finally{if(_)throw d}}}},{key:"_findItemCount",value:function(t,e){var i=0,n=e-t*this.ITEMS_PER_ROW;return i=n/this.ITEMS_PER_ROW>=1?this.ITEMS_PER_ROW:n%this.ITEMS_PER_ROW}},{key:"_updateNavControls",value:function(){0===this._prevBtn.alpha?this._pageIndex>0&&(TweenMax.to(this._prevBtn,.25,{alpha:1,ease:Sine.easeOut}),this._prevBtn.interactive=!0):0===this._pageIndex&&(TweenMax.to(this._prevBtn,.25,{alpha:0,ease:Sine.easeIn}),this._prevBtn.interactive=!1),0===this._nextBtn.alpha?this._pageIndex<this._arrBtnInfo.length-1&&(TweenMax.to(this._nextBtn,.25,{alpha:1,ease:Sine.easeOut}),this._nextBtn.interactive=!0):this._pageIndex===this._arrBtnInfo.length-1&&(TweenMax.to(this._nextBtn,.25,{alpha:0,ease:Sine.easeIn}),this._nextBtn.interactive=!1)}},{key:"_onPageIndex_Changed",value:function(){this._updateNavControls(),this._removeItems(),this._createItems(this._arrBtnInfo)}},{key:"_onNextButton_Click",value:function(){this._pageIndex<this._arrBtnInfo.length-1&&(this._pageIndex+=1,this._onPageIndex_Changed())}},{key:"_onPrevButton_Click",value:function(){this._pageIndex>0&&(this._pageIndex-=1,this._onPageIndex_Changed())}},{key:"_onMenuButton_Click",value:function(t){switch(this._type){case _["default"].TOOL.PENCIL:case _["default"].TOOL.BRUSH:case _["default"].TOOL.BUCKET:case _["default"].TOOL.INK_POT:case _["default"].TOOL.SPRAY:this.signals.onColourChanged.dispatch(u["default"].assets.getJSON("config").palettePanel.pages[this.PALETTE_TYPE_TO_TOOL[this._type][this._pageIndex]][t.index],this.PALETTE_TYPE_TO_TOOL[this._type][this._pageIndex],t.index);break;case _["default"].TOOL.STAMP:this.signals.onStampChanged.dispatch(u["default"].assets.getJSON("config").palettePanel.pages[this.PALETTE_TYPE_TO_TOOL[this._type][this._pageIndex]][t.index],this.PALETTE_TYPE_TO_TOOL[this._type][this._pageIndex],t.index)}this.hide(),u["default"].audio.playSound("sfx_generic_colour_type_change_00")}}]),e}(PIXI.Container);i["default"]=d},{"../../Common":3,"../../CommonGame":4}],39:[function(t,e,i){"use strict";function n(t){return t&&t.__esModule?t:{"default":t}}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function s(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Object.defineProperty(i,"__esModule",{value:!0});var r=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),l=function g(t,e,i){null===t&&(t=Function.prototype);var n=Object.getOwnPropertyDescriptor(t,e);if(void 0===n){var a=Object.getPrototypeOf(t);return null===a?void 0:g(a,e,i)}if("value"in n)return n.value;var o=n.get;if(void 0!==o)return o.call(i)},u=t("../../Common"),h=n(u),_=t("../../CommonGame"),d=n(_),c=t("./ConfirmationPanel"),p=n(c),f=function(t){function e(){a(this,e);var t=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t._canvasContainer=null,t._trashBgSprite=null,t._trashFgSprite=null,t}return s(e,t),r(e,[{key:"init",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"init",this).call(this),this._messageText.y+=20,this._trashBgSprite=new PIXI.Sprite(h["default"].assets.getTexture("icon_replay_bg")),this._trashBgSprite.anchor=new PIXI.Point(.5,.5),this._trashBgSprite.y=this._messageText.y-150,this._messageSprite.addChild(this._trashBgSprite),this._canvasContainer=new PIXI.Container,this._canvasContainer.anchor=new PIXI.Point(.5,.5),this._canvasContainer.scale=new PIXI.Point(.11,.11),this._canvasContainer.y=this._messageText.y-250,this._canvasContainer.rotation=.5*Math.PI,this._messageSprite.addChild(this._canvasContainer),this._canvasContainer.addChild(d["default"].createCanvasBg());var t="drawing";1===d["default"].selectedGallery&&(t="colouring");var i=new PIXI.Sprite(h["default"].assets.getTexture("canvas_"+t));i.anchor=new PIXI.Point(.5,.5),this._canvasContainer.addChild(i);var n=new PIXI.Sprite(h["default"].blankTexture);n.tint=16777215,n.width=d["default"].CANVAS_WIDTH,n.height=d["default"].CANVAS_HEIGHT,n.anchor=new PIXI.Point(.5,.5),this._canvasContainer.addChild(n),this._trashFgSprite=new PIXI.Sprite(h["default"].assets.getTexture("icon_replay_fg")),this._trashFgSprite.anchor=new PIXI.Point(.5,.5),this._trashFgSprite.x=this._trashBgSprite.x,this._trashFgSprite.y=this._trashBgSprite.y,this._messageSprite.addChild(this._trashFgSprite)}},{key:"show",value:function(t){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"show",this).call(this,t),this._canvasContainer.y=this._messageText.y-250,this._canvasContainer.alpha=1,this._trashFgSprite.scale=new PIXI.Point(1,1),this._trashBgSprite.scale=new PIXI.Point(1,1),TweenMax.to(this._canvasContainer,1,{y:this._trashBgSprite.y,ease:Sine.easeOut,repeat:-1,repeatDelay:.5,onRepeat:function(){this._canvasContainer.alpha=1},onRepeatScope:this}),TweenMax.to(this._canvasContainer,.5,{alpha:0,ease:Sine.easeOut,repeat:-1,repeatDelay:1,delay:.5}),TweenMax.fromTo(this._trashBgSprite.scale,.5,{x:.99,y:.99},{x:1,y:1,ease:Back.easeOut.config(100),repeat:-1,delay:.75,repeatDelay:1}),TweenMax.fromTo(this._trashFgSprite.scale,.5,{x:.99,y:.99},{x:1,y:1,ease:Back.easeOut.config(100),repeat:-1,delay:.75,repeatDelay:1})}},{key:"_hide",value:function(){l(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"_hide",this).call(this),TweenMax.killTweensOf(this._canvasContainer),TweenMax.killTweensOf(this._trashBgSprite.scale),TweenMax.killTweensOf(this._trashFgSprite.scale)}}]),e}(p["default"]);i["default"]=f},{"../../Common":3,"../../CommonGame":4,"./ConfirmationPanel":36}]},{},[25]);
//# sourceMappingURL=bundle.min.js.map
